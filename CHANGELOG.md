# 更新日志 (CHANGELOG)

本文件记录金融案件测试数据生成系统方案的所有重要变更。

---

## [v1.0.0-alpha] - 2026-01-19

### 新增 (Added)

#### 整体设计
- 完整的三阶段流程设计（原告起诉包→被告答辩包→法院审理包）
- 明确了证据包的独立性和第三阶段的引用约束
- 设计了符合诉讼程序的时间顺序生成逻辑

#### 阶段0：判决书解析与全局规划
- **0.1 结构化提取**：判决书结构化提取模板，输出JSON格式
- **0.2 脱敏替换策划**：
  - 人物Profile库设计（含详细个人信息）
  - 公司Profile库设计（含统一社会信用代码、经营范围等）
  - 机构Profile库设计
  - 编号体系规则设计（合同、抵押、股权质押、银行回单等）
  - 补充Profile库设计（设备供应商、运维公司等第三方）
- **0.3 交易结构重构**：
  - 交易结构图设计（售后回租模式、担保结构）
  - 交易时间线设计（仅交易事实，不含争议）
- **0.4 关键数字提取**：
  - 合同基础金额（原合同、调整后）
  - 租金安排（期限、期数、利率、总额）
  - 租金支付计划（12期详细数据）
  - 放款明细（逐笔）
  - 保险理赔明细（逐笔）
  - 违约相关金额
  - 诉讼费用
  - 判决金额
  - 关键时间点
- **0.5 证据归属规划**：
  - 证据归属规划表（CSV格式）
  - 证据归属方（原告/被告/双方/法院调取）
  - 关联交易节点标注

#### 阶段1-3：提示词设计
- 提示词通用模板框架（参数化、引用阶段0成果）
- **1.1 民事起诉状生成**：完整的起诉状结构和要求
- **1.2 原告证据包生成**：证据组组织、文件类型分类、完整内容要求
- **1.3 原告程序性文件生成**：授权委托书、保全申请、保单等
- **2.1 民事答辩状生成**：答辩状结构、针对性强、逐项回应
- **2.2 被告证据包生成**：独立性、支持抗辩、版本差异处理
- **2.3 被告程序性文件生成**：被告授权委托书、答辩人身份证明等
- **3.1 庭审笔录生成**：庭审程序记录、争议焦点、举证质证、法庭辩论
- **3.2 判决书脱敏替换**：全文替换、保持结构、一致性检查

#### 质量控制机制
- **三层质量控制架构**：
  - 第一层：即时检查器（嵌入生成过程）
  - 第二层：独立审核器（生成完成后）
  - 第三层：跨阶段一致性检查器（阶段结束时）
- **自动化检查规则库**：10条核心检查规则
  - 规则1：公司名称一致性
  - 规则2：人物信息一致性
  - 规则3：金额一致性
  - 规则4：日期一致性
  - 规则5：编号格式一致性
  - 规则6：表格完整性
  - 规则7：证据归属一致性
  - 规则8：计算逻辑正确性
  - 规则9：引用准确性
  - 规则10：格式规范性
- **质量检查报告生成**：结构化报告、问题统计、修正建议

#### 实施路径
- **第一阶段**：核心框架搭建（2-3周）
- **第二阶段**：阶段0实现（3-4周）
- **第三阶段**：阶段1-3实现（6-8周）
- **第四阶段**：质量控制完善（2-3周）
- **第五阶段**：测试与优化（2-3周）
- 总计：15-18周

#### 技术栈建议
- 后端：Python 3.10+ / FastAPI
- 大模型集成：OpenAI API / Anthropic API
- 前端（如需）：Vue.js 3 / React
- 数据处理：pandas, numpy
- 部署：Docker / Docker Compose

### 规划中 (Planned)

#### 测试验收标准
- 阶段0验收标准（结构化提取准确率、脱敏覆盖率等）
- 阶段1验收标准（起诉状完整性、证据包质量）
- 阶段2验收标准（答辩状针对性、证据包独立性）
- 阶段3验收标准（庭审笔录程序性、判决书替换完整性）
- 整体验收标准（逻辑自洽度、质量通过率）

#### 异常处理细节
- 生成异常场景（超时、Token限制、内容质量不达标）
- 数据异常场景（信息缺失、时间线冲突、Profile不完整）
- 质量异常场景（检查失败、不一致、无法自动修正）

#### 提示词优化策略
- 提示词效果评估框架
- 迭代优化机制
- 错误模式分析
- 薄弱环节识别

#### 可扩展性设计
- 案件类型扩展（借款合同、信用卡等）
- 地域差异适配
- 案件复杂度分级

### 已知限制 (Known Limitations)

1. **案件类型**：当前版本仅支持融资租赁合同纠纷
2. **复杂度**：复杂案件（多方当事人、反诉、第三人）可能需要额外调整
3. **语言**：仅支持中文案件判决书
4. **地域**：基于上海金融法院的文书格式，其他地区可能需要适配

### 变更说明

- 本版本为初始方案版本 (alpha)
- 在build session过程中将根据实战经验补充和完善
- 每次更新请在本文件记录变更内容

---

## 版本说明

### 版本号格式

```
v主版本.次版本.修订号-预发布标识
```

- **主版本**：重大架构变更、不兼容的修改
- **次版本**：新增功能（如新的提示词、新的检查规则）
- **修订号**：Bug修复、细节优化、文档更新
- **预发布标识**：alpha（开发中）、beta（测试中）、rc（候选发布）

### 更新流程

1. 在build session中根据经验发现需要调整的部分
2. 更新对应的文档或提示词
3. 在本CHANGELOG中记录变更
4. 如需要，更新VERSION文件中的版本号
