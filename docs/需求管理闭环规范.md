# 需求管理闭环规范

**目的**: 确保需求完整、开发理解、评审到位  
**日期**: 2026-01-27

---

## 一、问题诊断

### 1.1 本次项目的问题

| 环节 | 问题 | 后果 |
|------|------|------|
| 需求文档 | 讨论内容未全面反映 | 开发不知道LLM生成证据 |
| 开发交接 | 没有明确checklist | 开发遗漏保留功能 |
| 评审 | 只看新设计，没对照老功能 | 老功能丢失 |
| 沟通 | 没有确认开发理解 | 设计决策被误解 |

### 1.2 核心问题

> **需求文档 ≠ 会议讨论记录**
> 
> 需求文档必须是：
> 1. **完整的** - 所有讨论结论都要写进去
> 2. **明确的** - 不要让开发自己猜
> 3. **可验证的** - 有验收标准
> 4. **闭环的** - 开发知道做什么、测什么

---

## 二、完整的需求文档结构

### 2.1 文档链

```
┌─────────────────────────────────────────────────────────────┐
│  需求总览（1页）                                             │
│  - 核心设计原则                                              │
│  - 功能清单（保留+新增）                                      │
│  - 关键决策                                                  │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  详细需求文档（多页）                                         │
│  - 功能详情                                                  │
│  - 数据结构                                                  │
│  - 接口设计                                                  │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  开发交接清单（checklist）                                    │
│  - 开发必须做的事                                             │
│  - 开发必须保留的功能                                         │
│  - 开发必须解决的问题                                         │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  测试清单                                                    │
│  - 验收标准                                                  │
│  - 测试命令                                                  │
│  - Bug回归验证                                               │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 需求文档必须回答的问题

| 问题 | 必须在文档中回答 |
|------|-----------------|
| 做什么？ | 功能清单（保留+新增） |
| 不做什么？ | 明确排除的功能 |
| 解决什么问题？ | Bug列表 + 解决方案 |
| 怎么验证？ | 验收标准 + 测试命令 |
| 优先级？ | P0/P1/P2 标注 |

---

## 三、开发交接规范

### 3.1 交接清单checklist

在开发开始前，产品经理必须与开发逐项确认：

#### A. 核心理解（签字确认）

- [ ] **核心流程**：证据由LLM生成，不是程序生成
- [ ] **三层数据逻辑**：边界条件来自判决书，详细数据自动生成
- [ ] **保留功能**：Stage 0/1/2/3 共14个产物必须保留
- [ ] **新增功能**：DataGenerator、DynamicPromptBuilder、EvidenceRenderer
- [ ] **必须解决的Bug**：反脱敏、表格渲染、数据遗漏

**开发签字**: ____________  
**日期**: ____________

#### B. 功能清单确认

| 类别 | 功能 | 状态 | 开发确认 |
|------|------|------|---------|
| 保留 | Stage 0（5个产物） | 必须保留 | [ ] |
| 保留 | Stage 1（3个产物） | 必须保留 | [ ] |
| 保留 | Stage 2（3个产物） | 必须保留 | [ ] |
| 保留 | Stage 3（2个产物） | 必须保留 | [ ] |
| 保留 | PDF生成 | 必须保留 | [ ] |
| 新增 | DataGenerator | 需要实现 | [ ] |
| 新增 | DynamicPromptBuilder | 需要实现 | [ ] |
| 新增 | EvidenceRenderer | 需要实现 | [ ] |

#### C. Bug解决确认

| Bug | 解决方案 | 开发确认 |
|-----|---------|---------|
| BUG-001 公司脱敏 | 上下文注入 | [ ] |
| BUG-010 LLM创造脱敏 | 禁止新模式 | [ ] |
| BUG-011 租赁物清单 | DataGenerator | [ ] |
| BUG-012 抵押物清单 | DataGenerator | [ ] |
| BUG-004 Markdown表格 | 禁止+JSON+render_table | [ ] |

---

## 四、评审规范

### 4.1 评审前准备

开发提交评审前，必须提供：

| 材料 | 说明 |
|------|------|
| 设计文档 | 包含架构、数据结构、组件设计 |
| 功能对照表 | 对照需求文档，标注每个需求的状态 |
| 代码/实现计划 | 核心组件的伪代码或实现计划 |

### 4.2 评审checklist

产品经理评审时必须检查：

#### A. 功能完整性（对照需求）

| 需求 | 设计中是否覆盖 | 评审结果 |
|------|---------------|---------|
| Stage 0（5个产物） | [ ] | ✅ / ❌ |
| Stage 1（3个产物） | [ ] | ✅ / ❌ |
| Stage 2（3个产物） | [ ] | ✅ / ❌ |
| Stage 3（2个产物） | [ ] | ✅ / ❌ |
| PDF生成 | [ ] | ✅ / ❌ |

#### B. Bug解决（对照Bug列表）

| Bug | 设计中是否解决 | 评审结果 |
|-----|---------------|---------|
| BUG-001 | [ ] | ✅ / ❌ |
| BUG-010 | [ ] | ✅ / ❌ |
| BUG-011 | [ ] | ✅ / ❌ |
| BUG-012 | [ ] | ✅ / ❌ |
| BUG-004 | [ ] | ✅ / ❌ |

#### C. 架构合理性

| 检查项 | 评审结果 |
|--------|---------|
| 组件职责是否清晰 | ✅ / ❌ |
| 数据流是否合理 | ✅ / ❌ |
| 是否符合三层数据逻辑 | ✅ / ❌ |
| 是否有遗漏 | ✅ / ❌ |

### 4.3 评审结论

| 结论 | 说明 |
|------|------|
| ✅ 通过 | 所有检查项通过 |
| ⚠️ 有条件通过 | 部分项需要修改，限期整改 |
| ❌ 不通过 | 重大遗漏，需要重新设计 |

---

## 五、本次项目改进

### 5.1 当前状态

| 文档 | 状态 |
|------|------|
| 需求文档 v2.0功能保留清单 | ✅ 已更新 |
| 测试清单 | ✅ 已更新 |
| 开发交接清单 | ❌ 需要补充 |
| 开发签字确认 | ❌ 未完成 |

### 5.2 下一步行动

| 行动 | 负责人 | 状态 |
|------|--------|------|
| 创建开发交接清单checklist | 产品经理 | 待执行 |
| 与开发逐项确认 | 产品经理+开发 | 待执行 |
| 开发签字 | 开发 | 待执行 |
| 补充评审checklist | 产品经理 | 待执行 |

---

## 六、模板：开发交接清单

```markdown
# [项目名] 开发交接清单

**日期**: YYYY-MM-DD  
**版本**: v1.0

---

## 一、核心设计原则（签字确认）

我已理解并同意以下核心设计原则：

1. **核心流程**：___由___生成，不是___生成
2. **三层数据逻辑**：
   | 层级 | 数据 | 来源 | 真实数据要求 |
   |------|------|------|-------------|
   | ... | ... | ... | ... |
3. **保留功能**：___（共N个产物）必须保留
4. **新增功能**：___需要实现
5. **必须解决的Bug**：___

**开发签字**: ____________  
**日期**: ____________

---

## 二、功能清单

| 序号 | 功能 | 类别 | 状态 | 开发确认 |
|------|------|------|------|---------|
| 1 | ___ | 保留 | 必须保留 | [ ] |
| 2 | ___ | 新增 | 需要实现 | [ ] |
| ... | ... | ... | ... | ... |

---

## 三、Bug解决

| Bug ID | 问题 | 解决方案 | 开发确认 |
|--------|------|---------|---------|
| BUG-001 | ___ | ___ | [ ] |
| ... | ... | ... | ... |

---

## 四、验收标准

| 功能/Bug | 验收标准 | 测试方法 | 开发确认 |
|----------|---------|---------|---------|
| ___ | ___ | ___ | [ ] |
| ... | ... | ... | ... |

---
```

---

**创建日期**: 2026-01-27  
**下次更新**: 下一个项目开始时
