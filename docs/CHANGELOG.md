# CHANGELOG

**说明**: 每次发布新版本必须更新此文档  
**格式参考**: [Keep a Changelog](https://keepachangelog.com/)

---

## [v2.0] - 2026-01-27

### 新增
- DataGenerator自动生成设备名称和银行账号
- DynamicPromptBuilder上下文注入
- EvidenceRenderer合同和表格渲染
- 按判决书哈希缓存机制

### 修复
- BUG-001 公司脱敏名称未替换
- BUG-004 Markdown表格未渲染
- BUG-010 LLM创造新脱敏模式
- BUG-011 租赁物清单数据缺失
- BUG-012 抵押物清单数据缺失

### 变更
- 证据生成流程：完全自动化数据生成
- 反脱敏策略：从"生成后替换"改为"生成时提供上下文"
- 架构升级：从数据驱动改为文档驱动

---

## [v1.0] - 2026-01-26

### 新增
- 初始版本
- Stage 0/1/2/3证据生成流程
- PDF卷宗生成
- 基础反脱敏功能

### 已知问题
- 租赁物/抵押物清单数据反复遗漏
- 反脱敏不彻底（LLM创造新模式）
- PDF格式问题（表格、换行、分页）

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  判决书 → 诉求 → 合同 → 附件 → 证据集                        │
│                                                             │
│  所有数据自动生成，不需要人工准备                            │
│  同一判决书只生成一次数据，后续运行复用                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 核心设计决策（RFC-2026-01-27-001已定稿）

| 序号 | 问题 | 答案 |
|-----|------|------|
| 1 | 模板库的范围 | B - 运行时动态扩展 |
| 2 | 生成数据的合规性 | B - 与判决书描述匹配 |
| 3 | **数据生成策略** | **B - 按判决书缓存** |
| 4 | 证据文件缺失处理 | B - 降级为自动生成 |

**关于问题3的澄清**: 同一判决书只生成一次数据，后续运行复用；不同判决书生成新数据。

### 新增配置

```json
// config/template_libraries/ 模板库
├── company_names.json    // 公司名称模板
├── equipment_names.json  // 设备名称模板
└── locations.json        // 地址模板
```

### 废弃/修改的功能

| 功能 | v1.0 | v2.0 | 说明 |
|------|------|------|------|
| 0.4_key_numbers生成 | 从判决书提取 | 自动生成 | 方式变更 |
| 反脱敏处理 | 生成后替换 | 生成时提供上下文 | 时机变更 |
| 证据格式 | 多种格式实现 | 2种核心格式+扩展 | 范围缩小 |

### 测试变更

| 测试类型 | 新增内容 |
|---------|---------|
| 单元测试 | 数据生成器测试、模板库测试 |
| 集成测试 | 完整自动化流程测试 |
| Regression测试 | 核心功能回归、无硬编码检查 |

---

## v1.0 (2024-01-26)

### 初始版本

- 特定案件设计（融资租赁）
- 从判决书提取数据
- 多种证据格式实现
- 生成后反脱敏

### 已知问题

1. 租赁物/抵押物清单数据反复遗漏
2. 反脱敏不彻底（LLM创造新模式）
3. PDF格式问题（表格、换行、分页）
4. 依赖原始材料中的详细数据

---

## 文档索引

| 文档 | 当前版本 | 说明 |
|------|---------|------|
| [PRODUCT_REQUIREMENTS.md](PRODUCT_REQUIREMENTS.md) | v2.0 | 产品需求文档 |
| [TEST_PLAN.md](TEST_PLAN.md) | v2.0 | 测试方案 |
| [v1历史文档](v1_history/) | - | 之前版本 |

---

**创建日期**: 2024-01-27  
**最后更新**: 2024-01-27
