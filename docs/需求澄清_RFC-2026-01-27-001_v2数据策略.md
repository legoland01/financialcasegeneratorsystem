# 需求澄清：v2.0数据策略

**文档编号**: RFC-2026-01-27-001  
**版本**: v2.0  
**日期**: 2026-01-27  
**状态**: 已定稿

---

## 一、核心澄清

### 1.1 设计目标

v2.0的**核心设计目标**是：

> **完全自动化的证据集生成**
> - 判决书告诉系统"案件类型"和"边界条件"
> - 系统自动生成所有证据数据
> - 支持通过配置边界条件来测试数据不一致性

### 1.2 关键设计原则

| 原则 | 说明 |
|------|------|
| **判决书数据可用** | 判决书列出的数据（金额、日期、当事人）直接使用 |
| **判决书没有的数据自动生成** | 设备名称、规格型号、银行账号等用模板库+规则生成 |
| **边界条件可配置** | 用于测试场景，可以修改金额、日期等来生成"错误"证据 |

---

## 二、数据结构：三层设计

### 2.1 三层架构

```
┌─────────────────────────────────────────────────────────────┐
│ Layer 1: 交易核心结构（案件类型）                            │
│ - 案件类型: 融资租赁纠纷                                    │
│ - 涉及合同: 融资租赁合同、抵押合同                           │
│ - 合同关系: A公司从B公司租赁设备                            │
│ (不变的配置，判决书提供案件类型)                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ Layer 2: 边界条件/关键事实（必须来自判决书）                 │
│ - 合同金额: 1.5亿（判决书明确列出）                         │
│ - 利率: 6.1%（判决书明确列出）                              │
│ - 日期: 2021-02-24（判决书明确列出）                        │
│ - 当事人: 某某公司5、某某公司1（判决书列出）                 │
│ - 设备数量: 5台（判决书描述"62套设备"）                     │
│                                                             │
│ **重要**: 边界条件必须来自判决书                            │
│ **测试用途**: 可配置为不同值来生成"错误"证据                │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ Layer 3: 自动生成的详细数据（根据边界条件生成）              │
│ - 设备名称: 根据设备模板生成                                 │
│ - 规格型号: 根据设备模板生成                                 │
│ - 银行账号: 随机生成                                         │
│ - 租金计划: 根据金额、利率、期限计算                         │
│ (根据Layer 2自动计算)                                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 数据输入格式

```json
{
  "judgment_data": {
    "case_type": "融资租赁纠纷",
    "boundaries": {
      "contract_amount": 150000000,
      "interest_rate": 0.061,
      "signing_date": "2021-02-24",
      "lessor": "某某公司5",
      "lessee": "某某公司1",
      "equipment_count": 5
    }
  },
  
  "test_config": {
    "enable_error_injection": false,  // 测试时开启
    "error_rules": [
      {"field": "contract_amount", "offset_pct": 10}  // +10%用于测试
    ]
  },
  
  "template_library": {
    "company_names": ["长江某有限公司", "华鑫某集团"],
    "equipment_names": ["多联机中央空调系统", "电梯设备"]
  }
}
```

### 2.3 数据输出（0.4_key_numbers.json）

```json
{
  "案件核心结构": {
    "案件类型": "融资租赁纠纷",
    "合同关系": "租赁关系",
    "数据来源": "判决书"
  },
  
  "边界条件": {
    "合同金额": 150000000,
    "利率": 0.061,
    "签订日期": "2021-02-24",
    "当事人": ["某某公司5", "某某公司1"],
    "数据来源": "判决书",
    "测试标记": null  // 如有修改，标记为测试数据
  },
  
  "租赁物清单": [
    {
      "序号": 1,
      "设备名称": "多联机中央空调系统",
      "规格型号": "VRV VIII代",
      "数量": "10套",
      "评估价值": 50000000,
      "数据来源": "自动生成"
    }
  ],
  
  "租金支付计划": [
    // 根据边界条件中的金额、利率自动计算
  ]
}
```
┌─────────────────────────────────────────────────────────────┐
│ Layer 1: 交易核心结构（案件类型）                            │
│ - 案件类型: 融资租赁纠纷                                    │
│ - 涉及合同: 融资租赁合同、抵押合同                           │
│ - 合同关系: A公司从B公司租赁设备                            │
│ (不变的配置)                                                │
├─────────────────────────────────────────────────────────────┤
│ Layer 2: 边界条件/关键事实（可配置）                         │
│ - 合同金额: 1.5亿（可配置为1.6亿来测试）                    │
│ - 利率: 6.1%（可配置为7%来测试）                             │
│ - 设备数量: 5台（可配置为3台来测试）                         │
│ (测试时需要修改的配置)                                       │
├─────────────────────────────────────────────────────────────┤
│ Layer 3: 自动生成的详细数据（根据边界条件生成）              │
│ - 设备名称: 根据设备模板生成                                 │
│ - 规格型号: 根据设备模板生成                                 │
│ - 银行账号: 随机生成                                         │
│ - 租金计划: 根据金额、利率、期限计算                         │
│ (根据Layer 2自动计算)                                        │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 数据输入格式

```json
{
  "case_config": {
    "case_type": "融资租赁纠纷",
    "contracts": ["融资租赁合同", "抵押合同"]
  },
  
  "boundary_conditions": {
    "contract_amount": 150000000,
    "interest_rate": 0.061,
    "signing_date": "2021-02-24",
    "equipment_count": 5,
    "lessor": "某某公司5",
    "lessee": "某某公司1"
  },
  
  "template_library": {
    "company_names": ["长江某有限公司", "华鑫某集团"],
    "equipment_names": ["多联机中央空调系统", "电梯设备"]
  }
}
```

### 2.3 数据输出（0.4_key_numbers.json）

```json
{
  "核心结构": {
    "案件类型": "融资租赁纠纷",
    "合同关系": "租赁关系"
  },
  
  "边界条件": {
    "合同金额": 150000000,
    "利率": 0.061,
    "签订日期": "2021-02-24"
  },
  
  "租赁物清单": [
    {
      "序号": 1,
      "设备名称": "多联机中央空调系统",
      "规格型号": "VRV VIII代",
      "数量": "10套",
      "评估价值": 50000000
    }
    // ...共5项（根据boundary_conditions中的equipment_count生成）
  ],
  
  "租金支付计划": [
    // 根据合同金额、利率自动计算
  ]
}
```

---

## 三、数据来源策略

### 3.1 策略简述

| 策略 | 数据类型 | 处理方式 |
|------|---------|---------|
| **来自判决书** | 边界条件（金额、日期、当事人等） | 必须使用判决书的数据 |
| **生成** | 详细数据（设备名称、规格型号、银行账号等） | 模板库+规则生成 |

### 3.2 区分原因

**为什么这样设计？**

1. **一致性**: 合同金额应该与判决书一致
2. **可追溯性**: 边界条件有据可查（来自判决书）
3. **可测试性**: 可以修改边界条件来生成"错误"证据，测试系统能否发现不一致
4. **灵活性**: 自动生成的数据不影响案件的核心事实

### 3.3 边界条件必须来自判决书

```json
{
  "boundary_conditions": {
    "合同金额": 150000000,        // 判决书明确列出的金额
    "利率": 0.061,                 // 判决书明确列出的利率
    "签订日期": "2021-02-24",      // 判决书明确列出的日期
    "当事人": ["某某公司5", "某某公司1"],  // 判决书列出的当事人
    "数据来源": "判决书",          // 标记数据来源
    "测试标记": null               // 默认无标记
  }
}
```

### 3.4 测试场景配置

```json
{
  "test_mode": {
    "enabled": true,
    "description": "用于测试数据不一致性检测",
    "errors": [
      {
        "target": "boundary_conditions.contract_amount",
        "operation": "multiply",
        "value": 1.1  // 金额+10%，与租金计划不一致
      },
      {
        "target": "boundary_conditions.interest_rate", 
        "operation": "replace",
        "value": 0.08  // 利率改为8%
      }
    ]
  }
}
```

---

## 四、反脱敏策略

### 4.1 核心原则

**反脱敏库 = Prompt上下文**

不是"生成后存储再查询"，而是：
> **在Prompt中一次性提供所有上下文信息**

### 4.2 反脱敏库结构

```json
{
  "公司Profile库": {
    "某某公司5": {
      "公司名称": "东方国际融资租赁有限公司",
      "信用代码": "91310000MA1FL3L123",
      "法定代表人": "周明远",
      "注册地址": "中国（上海）自由贸易试验区世纪大道100号"
    }
  },
  
  "人物Profile库": {
    "张某": {
      "姓名": "张伟",
      "身份证": "360102197001011234"
    }
  }
}
```

### 4.3 Prompt中使用方式

```markdown
# 任务：生成融资租赁合同

## 当事人信息 - 必须使用以下真实信息
**甲方（出租人）**：
- 公司名称：东方国际融资租赁有限公司
- 统一社会信用代码：91310000MA1FL3L123
- 法定代表人：周明远
...
```

---

## 五、测试场景

### 5.1 正常生成

```json
{
  "boundary_conditions": {
    "contract_amount": 150000000,
    "interest_rate": 0.061
  }
}
```
→ 生成一致的证据集

### 5.2 错误探测测试

```json
{
  "boundary_conditions": {
    "contract_amount": 165000000,  // +10%
    "rent_schedule_base": 150000000  // 保持不变
  }
}
```
→ 生成矛盾的证据（合同金额≠租金计划总和）

### 5.3 边界测试

```json
{
  "boundary_conditions": {
    "interest_rate": 0.001,  // 极低利率
    "equipment_count": 100  // 大量设备
  }
}
```

---

## 六、对开发文档v1.0的纠正

### 6.1 需要纠正的内容

| 开发文档v1.0 | 纠正为 |
|-------------|-------|
| "P0: 从判决书提取" | 边界条件必须来自判决书（金额、日期、当事人等） |
| "P1: 从证据文件提取" | 证据数据是自动生成的，不需要"提取" |
| "P2: 自动生成后纳入反脱敏库" | 反脱敏库是Prompt上下文，一次性提供 |
| "核心数据来自判决书" | **边界条件**来自判决书，详细数据自动生成 |

### 6.2 正确的数据流

```
判决书
├── 边界条件（必须使用）→ 金额、日期、当事人、合同概述等
└── 案件类型 → 确定合同类型
         ↓
系统 → 使用判决书的边界条件
       → 自动生成详细数据（设备名称、银行账号等）
         ↓
输出 → 完整证据集
```

### 6.3 正确的数据来源

| 数据 | 来源 | 说明 |
|------|------|------|
| 合同金额 | 判决书 | 必须使用判决书列出的金额 |
| 利率 | 判决书 | 必须使用判决书列出的利率 |
| 签订日期 | 判决书 | 必须使用判决书列出的日期 |
| 当事人 | 判决书 | 必须使用判决书列出的当事人 |
| 设备名称 | 自动生成 | 模板库 |
| 规格型号 | 自动生成 | 模板库 |
| 银行账号 | 自动生成 | 随机规则 |
| 租金计划 | 计算生成 | 根据边界条件计算 |

---

## 八、其他待确认问题（已定稿）

| 序号 | 问题 | 选项 | 答案 |
|-----|------|------|------|
| 1 | 模板库的范围 | A: 预定义固定 / B: 运行时动态扩展 | **B** |
| 2 | 生成数据的合规性 | A: 合理即可 / B: 与判决书描述匹配 | **B** |
| 3 | 反脱敏库更新频率 | A: 每次运行更新 / B: 按判决书缓存 | **B** |

### 8.3 问题3: 数据生成策略（反脱敏库更新频率）

**答案**: B - 按判决书缓存

**核心原则**:
- **同一判决书**：只生成一次数据，后续运行复用已有数据（除非有缺漏需要补充）
- **不同判决书**：自动生成新的数据配置

**设计含义**:
1. 数据与判决书绑定，同一判决书产生一致的证据数据
2. 不同判决书可以使用不同的数据设置
3. 首次运行判决书时生成完整数据并缓存
4. 后续运行同一判决书时读取缓存，避免数据不一致

**技术实现要点**:
- 以判决书文件路径（或其哈希值）作为缓存键
- 缓存内容包括：边界条件、自动生成的设备清单、银行账号等
- 提供"强制刷新"选项用于重新生成

### 8.4 问题4: 证据文件缺失处理

**答案**: B - 降级为自动生成

如果判决书提到"详见附件"但附件不存在，系统应该：
1. 不是报错中断
2. 而是自动生成该附件的内容

这是"完全自动化"设计理念的体现。

---

**文档版本**: v2.0  
**状态**: 已定稿  
**创建日期**: 2026-01-27  
**最后更新**: 2026-01-27
