# v2.0 å®Œæ•´æµ‹è¯•æ¸…å•

**æ–‡æ¡£ç‰ˆæœ¬**: v1.1
**æ—¥æœŸ**: 2026-01-28
**ç›®çš„**: è¦†ç›–æ‰€æœ‰å·²çŸ¥bugï¼ŒéªŒè¯åŠŸèƒ½ä¿ç•™

> **æ³¨æ„**: è¯·ä½¿ç”¨ `run_complete.py` ä½œä¸ºç»Ÿä¸€å…¥å£è„šæœ¬ï¼ˆåŸ `run_full_regeneration.py` å·²åºŸå¼ƒï¼‰
> ```bash
> python3 run_complete.py  # å®Œæ•´æµç¨‹
> python3 run_complete.py --verify  # ä»…éªŒè¯
> ```

---

## ä¸€ã€Bugå†å²è®°å½•æ±‡æ€»

### 1.1 å·²ä¿®å¤Bugï¼ˆå¿…é¡»å›å½’éªŒè¯ï¼‰

| Bug ID | é—®é¢˜ | çŠ¶æ€ | éªŒè¯æ–¹æ³• |
|--------|------|------|---------|
| BUG-007 | å ä½ç¬¦å·²æ¸…ç† | âœ… å·²ä¿®å¤ | æ£€æŸ¥PDFæ— "ï¼ˆæ­¤å¤„å¡«å†™XXXï¼‰" |
| BUG-008 | äººç‰©è„±æ•å·²æ›¿æ¢ | âœ… å·²ä¿®å¤ | æ£€æŸ¥PDFæ— "å‘¨æŸ"ç­‰ |
| BUG-009 | æœºæ„è„±æ•å·²æ›¿æ¢ | âœ… å·²ä¿®å¤ | æ£€æŸ¥PDFæ— "æŸæŸå¾‹å¸ˆäº‹åŠ¡æ‰€" |
| FIX-001 | è¯æ®åŒ…åªç”Ÿæˆ1ç»„ | âœ… å·²ä¿®å¤ | æ£€æŸ¥ç”Ÿæˆæ‰€æœ‰8ä¸ªè¯æ®ç»„ |

### 1.2 å¾…ä¿®å¤Bugï¼ˆå¿…é¡»éªŒè¯ä¿®å¤ï¼‰

| Bug ID | é—®é¢˜ | ä¸¥é‡ç¨‹åº¦ | éªŒè¯æ–¹æ³• |
|--------|------|---------|---------|
| BUG-001 | å…¬å¸è„±æ•åç§°æœªæ›¿æ¢ | ğŸ”´ é«˜ | æ£€æŸ¥PDFæ— "æŸæŸå…¬å¸1/2/5/6" |
| BUG-010 | LLMåˆ›é€ æ–°è„±æ•æ¨¡å¼ | ğŸ”´ é«˜ | æ£€æŸ¥PDFæ— "é•¿æ±ŸæŸæœ‰é™å…¬å¸" |
| BUG-011 | ç§Ÿèµç‰©æ¸…å•æ•°æ®ç¼ºå¤± | ğŸ”´ é«˜ | æ£€æŸ¥0.4_key_numbersæœ‰5é¡¹ |
| BUG-012 | æŠµæŠ¼ç‰©æ¸…å•æ•°æ®ç¼ºå¤± | ğŸ”´ é«˜ | æ£€æŸ¥0.4_key_numbersæœ‰1é¡¹ |
| BUG-005 | ç§Ÿé‡‘è®¡åˆ’ä¸å®Œæ•´ | ğŸŸ¡ ä¸­ | æ£€æŸ¥ç§Ÿé‡‘è®¡åˆ’æœ‰12æœŸ |
| BUG-004 | Markdownè¡¨æ ¼æœªæ¸²æŸ“ | ğŸŸ¡ ä¸­ | æ£€æŸ¥PDFæ— "\| :--- \|"æ ¼å¼ |
| BUG-006 | ç§Ÿé‡‘è¡¨æ ¼æœªæ¸²æŸ“ | ğŸŸ¡ ä¸­ | æ£€æŸ¥PDFæœ‰ç§Ÿé‡‘è¡¨æ ¼ |

### 1.3 v2.0æ–°éœ€æ±‚ï¼ˆå¿…é¡»å®ç°ï¼‰

| éœ€æ±‚ID | åŠŸèƒ½ | è¯´æ˜ | éªŒè¯æ–¹æ³• |
|--------|------|------|---------|
| REQ-LLM | **LLMç”Ÿæˆè¯æ®** | æ‰€æœ‰è¯æ®å†…å®¹ç”±LLMç”Ÿæˆï¼Œä¸æ˜¯ç¨‹åºç”Ÿæˆ | æ£€æŸ¥è¯æ®æ–‡ä»¶æ˜¯LLMç”Ÿæˆçš„å®Œæ•´å†…å®¹ |
| REQ-001 | æŒ‰åˆ¤å†³ä¹¦ç¼“å­˜ | åŒä¸€åˆ¤å†³ä¹¦ä¸¤æ¬¡è¿è¡Œæ•°æ®ä¸€è‡´ | ä¸¤æ¬¡è¿è¡Œæ•°æ®ç›¸åŒ |
| REQ-002 | è¾¹ç•Œæ¡ä»¶è‡ªåŠ¨æå– | ä»åˆ¤å†³ä¹¦æå–é‡‘é¢ã€æ—¥æœŸç­‰ | è¾¹ç•Œæ¡ä»¶æ¥è‡ªåˆ¤å†³ä¹¦ |
| REQ-003 | è®¾å¤‡æ¸…å•è‡ªåŠ¨ç”Ÿæˆ | ä¸ä½¿ç”¨"æŸæŸ"å ä½ç¬¦ | è®¾å¤‡åç§°åˆç† |
| REQ-004 | ä¸Šä¸‹æ–‡æ³¨å…¥åè„±æ• | Promptä¸­åŒ…å«çœŸå®ä¿¡æ¯ | åè„±æ•æ­£ç¡® |

---

## äºŒã€åŠŸèƒ½ä¿ç•™æµ‹è¯•ï¼ˆ14ä¸ªäº§ç‰©ï¼‰

### Stage 0 - 5ä¸ªäº§ç‰©

| åºå· | äº§ç‰©æ–‡ä»¶ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ | çŠ¶æ€ |
|------|---------|---------|---------|------|
| 1 | 0.1ç»“æ„åŒ–æå– | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |
| 2 | 0.2è„±æ•è®¡åˆ’ | æ£€æŸ¥å…¬å¸Profileåº“ | âœ… å®Œæ•´ | |
| 3 | 0.3äº¤æ˜“é‡æ„ | æ£€æŸ¥äº¤æ˜“ç»“æ„ | âœ… å­˜åœ¨ | |
| 4 | 0.4å…³é”®æ•°å­— | æ£€æŸ¥ç§Ÿèµç‰©æ¸…å• | âœ… 5é¡¹ | |
| 5 | 0.5è¯æ®è§„åˆ’ | æ£€æŸ¥8ä¸ªè¯æ®ç»„ | âœ… å®Œæ•´ | |

**éªŒè¯å‘½ä»¤**:
```bash
python3 -c "
from pathlib import Path
import json

stage0_dir = Path('outputs/stage0')
files = ['0.1_structured_extraction.json', '0.2_anonymization_plan.json', 
         '0.3_transaction_reconstruction.json', '0.4_key_numbers.json', 
         '0.5_evidence_planning.json']

for f in files:
    p = stage0_dir / f
    if p.exists():
        print(f'âœ… {f}')
        if f == '0.4_key_numbers.json':
            data = json.loads(p.read_text())
            rental = data.get('ç§Ÿèµç‰©æ¸…å•', [])
            collateral = data.get('æŠµæŠ¼ç‰©æ¸…å•', [])
            print(f'   ç§Ÿèµç‰©æ¸…å•: {len(rental)}é¡¹')
            print(f'   æŠµæŠ¼ç‰©æ¸…å•: {len(collateral)}é¡¹')
    else:
        print(f'âŒ {f} ä¸å­˜åœ¨')
"
```

### Stage 1 - 3ä¸ªäº§ç‰©

| åºå· | äº§ç‰©æ–‡ä»¶ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ | çŠ¶æ€ |
|------|---------|---------|---------|------|
| 1 | æ°‘äº‹èµ·è¯‰çŠ¶ | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |
| 2 | 8ä¸ªè¯æ®ç»„ | æ£€æŸ¥è¯æ®ç»„1-8 | âœ… 8ç»„å®Œæ•´ | |
| 3 | ç¨‹åºæ€§æ–‡ä»¶ | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |

**éªŒè¯å‘½ä»¤**:
```bash
python3 -c "
from pathlib import Path

stage1_dir = Path('outputs/stage1')
print('âœ… èµ·è¯‰çŠ¶:', (stage1_dir / 'æ°‘äº‹èµ·è¯‰çŠ¶.txt').exists())

# æ£€æŸ¥8ä¸ªè¯æ®ç»„
evidence_dir = stage1_dir / 'evidence'
if evidence_dir.exists():
    groups = set()
    for f in evidence_dir.glob('*è¯æ®ç»„*.txt'):
        import re
        match = re.search(r'è¯æ®ç»„(\d+)', f.name)
        if match:
            groups.add(int(match.group(1)))
    print(f'âœ… è¯æ®ç»„: {sorted(groups)}')

print('âœ… ç¨‹åºæ€§æ–‡ä»¶:', (stage1_dir / 'åŸå‘Šç¨‹åºæ€§æ–‡ä»¶.txt').exists())
"
```

### Stage 2 - 3ä¸ªäº§ç‰©

| åºå· | äº§ç‰©æ–‡ä»¶ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ | çŠ¶æ€ |
|------|---------|---------|---------|------|
| 1 | ç­”è¾©çŠ¶ | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |
| 2 | è¢«å‘Šè¯æ®åŒ… | æ£€æŸ¥è¢«å‘Šè¯æ® | âœ… å­˜åœ¨ | |
| 3 | ç¨‹åºæ–‡ä»¶ | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |

**éªŒè¯å‘½ä»¤**:
```bash
python3 -c "
from pathlib import Path

stage2_dir = Path('outputs/stage2')
print('âœ… ç­”è¾©çŠ¶:', (stage2_dir / 'ç­”è¾©çŠ¶.txt').exists())
print('âœ… è¢«å‘Šè¯æ®åŒ…:', any((stage2_dir / 'è¢«å‘Šè¯æ®åŒ…').glob('*.txt')) if (stage2_dir / 'è¢«å‘Šè¯æ®åŒ…').exists() else 'âŒ ä¸å­˜åœ¨')
print('âœ… è¢«å‘Šç¨‹åºæ–‡ä»¶:', (stage2_dir / 'è¢«å‘Šç¨‹åºæ€§æ–‡ä»¶.txt').exists())
"
```

### Stage 3 - 2ä¸ªäº§ç‰©

| åºå· | äº§ç‰©æ–‡ä»¶ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ | çŠ¶æ€ |
|------|---------|---------|---------|------|
| 1 | åº­å®¡ç¬”å½• | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |
| 2 | åˆ¤å†³ä¹¦è„±æ• | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |

**éªŒè¯å‘½ä»¤**:
```bash
python3 -c "
from pathlib import Path

stage3_dir = Path('outputs/stage3')
print('âœ… åº­å®¡ç¬”å½•:', (stage3_dir / 'åº­å®¡ç¬”å½•.txt').exists())
print('âœ… åˆ¤å†³ä¹¦è„±æ•:', (stage3_dir / 'åˆ¤å†³ä¹¦_è„±æ•ç‰ˆ.txt').exists())
"
```

### PDFç”Ÿæˆ

| åŠŸèƒ½ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ | çŠ¶æ€ |
|------|---------|---------|------|
| å®Œæ•´å·å®—PDF | æ£€æŸ¥æ–‡ä»¶å­˜åœ¨ | âœ… å­˜åœ¨ | |
| æ™ºèƒ½åˆ†é¡µ | æ£€æŸ¥æ¯ä»½è¯æ®å¦èµ·ä¸€é¡µ | âœ… æ­£ç¡® | |
| é¡µç è¿ç»­ | æ£€æŸ¥é¡µç  | âœ… è¿ç»­ | |
| è´¨é‡æŠ¥å‘Š | æ£€æŸ¥æ¯ä¸ªäº§ç‰©æœ‰è´¨é‡æŠ¥å‘Š | âœ… å®Œæ•´ | |

**éªŒè¯å‘½ä»¤**:
```bash
python3 -c "
from pathlib import Path

pdf = Path('outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf')
print('âœ… PDFå­˜åœ¨:', pdf.exists())
print('âœ… PDFå¤§å°:', f'{pdf.stat().st_size / 1024:.0f}KB')

import PyPDF2
reader = PyPDF2.PdfReader(str(pdf))
print('âœ… é¡µæ•°:', len(reader.pages))
"
```

---

## ä¸‰ã€Bugä¿®å¤éªŒè¯æµ‹è¯•

### BUG-001: å…¬å¸è„±æ•åç§°æ›¿æ¢

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
import PyPDF2
from pathlib import Path

pdf = PyPDF2.PdfReader(str(Path('outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf')))
text = ''.join([p.extract_text() or '' for p in pdf.pages])

checks = [
    ('æŸæŸå…¬å¸1', 0),
    ('æŸæŸå…¬å¸2', 0),
    ('æŸæŸå…¬å¸5', 0),
    ('æŸæŸå…¬å¸6', 0),
]

all_pass = True
for name, expected in checks:
    count = text.count(name)
    status = 'âœ…' if count == expected else 'âŒ'
    if count != expected:
        all_pass = False
    print(f'{status} {name}: {count}å¤„')

print('ç»“è®º:', 'âœ… é€šè¿‡' if all_pass else 'âŒ å¤±è´¥')
"
```

### BUG-010: LLMåˆ›é€ æ–°è„±æ•æ¨¡å¼

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
import PyPDF2
from pathlib import Path

pdf = PyPDF2.PdfReader(str(Path('outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf')))
text = ''.join([p.extract_text() or '' for p in pdf.pages])

# æ£€æŸ¥LLMåˆ›é€ çš„æ–°è„±æ•æ¨¡å¼
checks = [
    'é•¿æ±ŸæŸæœ‰é™å…¬å¸',
    'åé‘«æŸ',
    'å¼ ä¼Ÿ (å…¬å¸',
    'å¼ æµ·å³° (å…¬å¸',
]

for name in checks:
    count = text.count(name)
    status = 'âŒ' if count > 0 else 'âœ…'
    print(f'{status} {name}: {count}å¤„')
"
```

### BUG-011/BUG-012: ç§Ÿèµç‰©/æŠµæŠ¼ç‰©æ¸…å•

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
import json
from pathlib import Path

data = json.loads((Path('outputs/stage0/0.4_key_numbers.json')).read_text())

# æ£€æŸ¥ç§Ÿèµç‰©æ¸…å•
rental = data.get('ç§Ÿèµç‰©æ¸…å•', [])
print('ç§Ÿèµç‰©æ¸…å•:')
if len(rental) > 0:
    for item in rental:
        print(f'  âœ… {item.get(\"åºå·\")} {item.get(\"åç§°\")} {item.get(\"è¯„ä¼°ä»·å€¼\")}')
else:
    print('  âŒ ç¼ºå¤±')

# æ£€æŸ¥æŠµæŠ¼ç‰©æ¸…å•
collateral = data.get('æŠµæŠ¼ç‰©æ¸…å•', [])
print('æŠµæŠ¼ç‰©æ¸…å•:')
if len(collateral) > 0:
    for item in collateral:
        print(f'  âœ… {item.get(\"åç§°\")} {item.get(\"è¯„ä¼°ä»·å€¼\")}')
else:
    print('  âŒ ç¼ºå¤±')
"
```

### BUG-004: Markdownè¡¨æ ¼æ¸²æŸ“

**ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä¸­  
**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
import PyPDF2
from pathlib import Path

pdf = PyPDF2.PdfReader(str(Path('outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf')))

# æ£€æŸ¥Markdownè¡¨æ ¼æ ¼å¼ï¼ˆ| å’Œ :--- åŒæ—¶å­˜åœ¨ï¼‰
markdown_tables = 0
for page in pdf.pages:
    text = page.extract_text() or ''
    if '|' in text and ':---' in text:
        # æ‰¾åˆ°Markdownè¡¨æ ¼æ ¼å¼
        lines = text.split('\n')
        for i, line in enumerate(lines):
            if '|' in line and (i+1 < len(lines)) and ':---' in lines[i+1]:
                markdown_tables += 1

print(f'Markdownè¡¨æ ¼é—®é¢˜: {markdown_tables}å¤„')
print('ç»“è®º:', 'âœ… é€šè¿‡' if markdown_tables == 0 else 'âŒ å¤±è´¥ - å­˜åœ¨Markdownæ ¼å¼è¡¨æ ¼')
"

# éªŒè¯çœŸæ­£çš„PDFè¡¨æ ¼å­˜åœ¨
python3 -c "
import json
from pathlib import Path

# æ£€æŸ¥0.4_key_numbersä¸­çš„è¡¨æ ¼æ•°æ®æ˜¯å¦å®Œæ•´
data = json.loads((Path('outputs/stage0/0.4_key_numbers.json')).read_text())

print('è¡¨æ ¼æ•°æ®æ£€æŸ¥:')
rental = data.get('ç§Ÿèµç‰©æ¸…å•', [])
print(f'  ç§Ÿèµç‰©æ¸…å•: {len(rental)}é¡¹ - {\"âœ…\" if len(rental) > 0 else \"âŒ\"}')

collateral = data.get('æŠµæŠ¼ç‰©æ¸…å•', [])
print(f'  æŠµæŠ¼ç‰©æ¸…å•: {len(collateral)}é¡¹ - {\"âœ…\" if len(collateral) > 0 else \"âŒ\"}')

rent_plan = data.get('ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’', [])
print(f'  ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’: {len(rent_plan)}æœŸ - {\"âœ…\" if len(rent_plan) >= 12 else \"âŒ\"}')
"

### BUG-005: ç§Ÿé‡‘è®¡åˆ’å®Œæ•´æ€§

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
import json
from pathlib import Path

data = json.loads((Path('outputs/stage0/0.4_key_numbers.json')).read_text())
rent_plan = data.get('ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’', [])

print(f'ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’: {len(rent_plan)}æœŸ')
print('ç»“è®º:', 'âœ… å®Œæ•´(12æœŸ)' if len(rent_plan) >= 12 else 'âŒ ä¸å®Œæ•´')
"
```

---

## å››ã€v2.0æ–°åŠŸèƒ½æµ‹è¯•

### REQ-LLM: LLMç”Ÿæˆè¯æ®

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
from pathlib import Path

# æ£€æŸ¥è¯æ®æ–‡ä»¶æ˜¯LLMç”Ÿæˆçš„å®Œæ•´å†…å®¹ï¼Œä¸æ˜¯ç¨‹åºç”Ÿæˆçš„
evidence_file = Path('outputs/stage1/evidence/è¯æ®ç»„1_E001_èèµ„ç§ŸèµåˆåŒ.txt')

if evidence_file.exists():
    content = evidence_file.read_text(encoding='utf-8')
    
    # æ£€æŸ¥æ˜¯å®Œæ•´å†…å®¹ï¼Œä¸æ˜¯å ä½ç¬¦
    has_content = len(content) > 500  # åˆåŒåº”è¯¥æœ‰è¶³å¤Ÿå†…å®¹
    has_real_names = 'æœ‰é™å…¬å¸' in content  # æœ‰çœŸå®å…¬å¸åç§°
    has_dates = '2021' in content or '2022' in content  # æœ‰æ—¥æœŸ
    
    print('è¯æ®æ–‡ä»¶æ£€æŸ¥:')
    print(f'  âœ… æ–‡ä»¶å­˜åœ¨')
    print(f'  å†…å®¹é•¿åº¦: {len(content)}å­—ç¬¦ - {\"âœ…\" if has_content else \"âŒ\"}'  )
    print(f'  åŒ…å«çœŸå®åç§°: {\"âœ…\" if has_real_names else \"âŒ\"}')
    print(f'  åŒ…å«æ—¥æœŸ: {\"âœ…\" if has_dates else \"âŒ\"}')
    
    if has_content and has_real_names and has_dates:
        print('ç»“è®º: âœ… è¯æ®ç”±LLMç”Ÿæˆï¼ˆå®Œæ•´å†…å®¹ï¼‰')
    else:
        print('ç»“è®º: âŒ è¯æ®å¯èƒ½ä¸å®Œæ•´')
else:
    print('âŒ è¯æ®æ–‡ä»¶ä¸å­˜åœ¨')
"
```

**éªŒè¯è¦ç‚¹**ï¼š
- è¯æ®æ–‡ä»¶æ˜¯LLMç”Ÿæˆçš„å®Œæ•´å†…å®¹
- ä¸æ˜¯ç¨‹åºç”Ÿæˆçš„ç®€å•æ¨¡æ¿
- åŒ…å«çœŸå®çš„å…¬å¸åç§°ã€æ—¥æœŸã€é‡‘é¢ç­‰
- ä¸æ˜¯å ä½ç¬¦æˆ–æ‘˜è¦

**æµ‹è¯•æ–¹æ³•**:
```bash
# æ­¥éª¤1: é¦–æ¬¡è¿è¡Œï¼ˆå®Œæ•´æµç¨‹ï¼‰
python3 run_complete.py

# æ­¥éª¤2: æ£€æŸ¥ç¼“å­˜
ls -la cache/*.json

# æ­¥éª¤3: å†æ¬¡è¿è¡Œï¼ˆåº”è¯¥ä½¿ç”¨ç¼“å­˜ï¼‰
python3 run_complete.py

# æ­¥éª¤4: æ¯”è¾ƒä¸¤æ¬¡ç”Ÿæˆçš„æ•°æ®
python3 -c "
import json
from pathlib import Path

# æ£€æŸ¥ä¸¤æ¬¡è¿è¡Œçš„è®¾å¤‡æ¸…å•æ˜¯å¦ä¸€è‡´
# ï¼ˆå¦‚æœä½¿ç”¨ç¼“å­˜ï¼Œåº”è¯¥ä¸€è‡´ï¼‰
"
```

### REQ-002: è¾¹ç•Œæ¡ä»¶è‡ªåŠ¨æå–

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
import json
from pathlib import Path

# æ£€æŸ¥è¾¹ç•Œæ¡ä»¶æ˜¯å¦ä»åˆ¤å†³ä¹¦æå–
data = json.loads((Path('outputs/stage0/0.1_structured_extraction.json')).read_text())

# åº”è¯¥æœ‰æå–çš„æ¡ˆä»¶ä¿¡æ¯
print('æ¡ˆä»¶åŸºæœ¬ä¿¡æ¯:', 'âœ… å­˜åœ¨' if 'æ¡ˆä»¶åŸºæœ¬ä¿¡æ¯' in data else 'âŒ ç¼ºå¤±')
"
```

### REQ-003: è®¾å¤‡æ¸…å•è‡ªåŠ¨ç”Ÿæˆ

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
import json
from pathlib import Path

data = json.loads((Path('outputs/stage0/0.4_key_numbers.json')).read_text())
rental = data.get('ç§Ÿèµç‰©æ¸…å•', [])

# æ£€æŸ¥è®¾å¤‡åç§°ä¸ä½¿ç”¨'æŸæŸ'
has_placeholder = any('æŸ' in item.get('åç§°', '') for item in rental)
print('è®¾å¤‡åç§°ä½¿ç”¨å ä½ç¬¦:', 'âŒ æ˜¯' if has_placeholder else 'âœ… å¦')
"
```

### REQ-004: ä¸Šä¸‹æ–‡æ³¨å…¥åè„±æ•

**æµ‹è¯•æ–¹æ³•**:
```bash
python3 -c "
from pathlib import Path

# æ£€æŸ¥Promptæ¨¡æ¿ä¸­æ˜¯å¦åŒ…å«çœŸå®ä¿¡æ¯
# è¿™éœ€è¦æ£€æŸ¥DynamicPromptBuilderçš„å®ç°
print('æ£€æŸ¥DynamicPromptBuilderæ˜¯å¦å®ç°ä¸Šä¸‹æ–‡æ³¨å…¥...')
"
```

---

## äº”ã€å®Œæ•´å›å½’æµ‹è¯•

### 5.1 ä¸€é”®è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
#!/bin/bash
# run_full_test.sh

echo "========================================"
echo "v2.0 å®Œæ•´å›å½’æµ‹è¯•"
echo "========================================"

# 1. è¿è¡Œå®Œæ•´ç”Ÿæˆ
echo "æ­¥éª¤1: è¿è¡Œå®Œæ•´ç”Ÿæˆ..."
python3 run_complete.py

# 2. æµ‹è¯•Stage 0äº§ç‰©
echo ""
echo "æ­¥éª¤2: æµ‹è¯•Stage 0äº§ç‰©..."
python3 << 'PYTHON'
import json
from pathlib import Path

stage0_dir = Path('outputs/stage0')
tests_passed = 0
tests_total = 0

# æµ‹è¯•5ä¸ªäº§ç‰©
for f in ['0.1_structured_extraction.json', '0.2_anonymization_plan.json', 
          '0.3_transaction_reconstruction.json', '0.4_key_numbers.json', 
          '0.5_evidence_planning.json']:
    tests_total += 1
    if (stage0_dir / f).exists():
        print(f'âœ… {f}')
        tests_passed += 1
    else:
        print(f'âŒ {f} ä¸å­˜åœ¨')

# æµ‹è¯•å…³é”®æ•°æ®
data = json.loads((stage0_dir / '0.4_key_numbers.json').read_text())
tests_total += 1
if len(data.get('ç§Ÿèµç‰©æ¸…å•', [])) >= 5:
    print('âœ… ç§Ÿèµç‰©æ¸…å•: 5é¡¹')
    tests_passed += 1
else:
    print(f'âŒ ç§Ÿèµç‰©æ¸…å•: {len(data.get(\"ç§Ÿèµç‰©æ¸…å•\", []))}é¡¹')

tests_total += 1
if len(data.get('æŠµæŠ¼ç‰©æ¸…å•', [])) >= 1:
    print('âœ… æŠµæŠ¼ç‰©æ¸…å•: 1é¡¹')
    tests_passed += 1
else:
    print(f'âŒ æŠµæŠ¼ç‰©æ¸…å•: ç¼ºå¤±')

print(f'')
print(f'Stage 0æµ‹è¯•: {tests_passed}/{tests_total} é€šè¿‡')
PYTHON

# 3. æµ‹è¯•åè„±æ•
echo ""
echo "æ­¥éª¤3: æµ‹è¯•åè„±æ•..."
python3 << 'PYTHON'
import PyPDF2
from pathlib import Path

pdf = PyPDF2.PdfReader(str(Path('outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf')))
text = ''.join([p.extract_text() or '' for p in pdf.pages])

tests = [
    ('æŸæŸå…¬å¸1', 0),
    ('æŸæŸå…¬å¸5', 0),
    ('é•¿æ±ŸæŸ', 0),
]

all_pass = True
for name, expected in tests:
    count = text.count(name)
    status = 'âœ…' if count == expected else 'âŒ'
    if count != expected:
        all_pass = False
    print(f'{status} {name}: {count}å¤„')

print('ç»“è®º:', 'âœ… é€šè¿‡' if all_pass else 'âŒ å¤±è´¥')
PYTHON

# 4. æµ‹è¯•PDFäº§ç‰©
echo ""
echo "æ­¥éª¤4: æµ‹è¯•PDF..."
python3 << 'PYTHON'
from pathlib import Path
import PyPDF2

pdf = Path('outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf')
if pdf.exists():
    reader = PyPDF2.PdfReader(str(pdf))
    print(f'âœ… PDF: {len(reader.pages)}é¡µ')
else:
    print('âŒ PDFä¸å­˜åœ¨')
PYTHON

echo ""
echo "========================================"
echo "æµ‹è¯•å®Œæˆ"
echo "========================================"
```

### 5.2 æµ‹è¯•ç»“æœæ±‡æ€»è¡¨

| æµ‹è¯•ç±»åˆ« | æµ‹è¯•é¡¹æ•° | é€šè¿‡æ•° | å¤±è´¥æ•° | çŠ¶æ€ |
|---------|---------|-------|-------|------|
| Stage 0äº§ç‰© | 5 | | | |
| Stage 1äº§ç‰© | 3 | | | |
| Stage 2äº§ç‰© | 3 | | | |
| Stage 3äº§ç‰© | 2 | | | |
| PDFç”Ÿæˆ | 4 | | | |
| BUGä¿®å¤ | 6 | | | |
| **v2.0æ–°åŠŸèƒ½** | **5** | | | |
| **æ€»è®¡** | **28** | | | |

---

## å…­ã€éªŒæ”¶æ ‡å‡†

### å¿…é¡»é€šè¿‡ï¼ˆP0ï¼‰

- [ ] **è¯æ®ç”±LLMç”Ÿæˆ** - è¯æ®æ–‡ä»¶æ˜¯LLMç”Ÿæˆçš„å®Œæ•´å†…å®¹ï¼Œä¸æ˜¯ç¨‹åºç”Ÿæˆ
- [ ] Stage 0æ‰€æœ‰5ä¸ªäº§ç‰©å®Œæ•´ç”Ÿæˆ
- [ ] Stage 1æ‰€æœ‰8ä¸ªè¯æ®ç»„å®Œæ•´ç”Ÿæˆ
- [ ] åè„±æ•æ— "æŸæŸå…¬å¸1/2/5/6"
- [ ] åè„±æ•æ— "é•¿æ±ŸæŸ"ç­‰LLMåˆ›é€ æ¨¡å¼
- [ ] **ç¦æ­¢Markdownè¡¨æ ¼** - PDFä¸­æ—  `| :--- |` æ ¼å¼
- [ ] è¡¨æ ¼æ•°æ®JSONä¼ é€’ - 0.4_key_numbersä¸­æœ‰è¡¨æ ¼æ•°æ®
- [ ] çœŸå®PDFè¡¨æ ¼æ¸²æŸ“ - EvidenceRenderer.render_table()å·¥ä½œ
- [ ] ç§Ÿèµç‰©æ¸…å•æœ‰5é¡¹æ•°æ®
- [ ] æŠµæŠ¼ç‰©æ¸…å•æœ‰1é¡¹æ•°æ®
- [ ] å®Œæ•´å·å®—PDFç”ŸæˆæˆåŠŸ

### åº”è¯¥é€šè¿‡ï¼ˆP1ï¼‰

- [ ] Stage 2ç­”è¾©çŠ¶å®Œæ•´ç”Ÿæˆ
- [ ] Stage 3åº­å®¡ç¬”å½•å®Œæ•´ç”Ÿæˆ
- [ ] ç§Ÿé‡‘è®¡åˆ’æœ‰12æœŸ
- [ ] æ¯ä¸ªäº§ç‰©æœ‰è´¨é‡æŠ¥å‘Š

### v2.0åŠ åˆ†é¡¹

- [ ] åŒä¸€åˆ¤å†³ä¹¦å¤šæ¬¡è¿è¡Œæ•°æ®ä¸€è‡´
- [ ] è¾¹ç•Œæ¡ä»¶è‡ªåŠ¨ä»åˆ¤å†³ä¹¦æå–
- [ ] è®¾å¤‡æ¸…å•ä¸ä½¿ç”¨"æŸæŸ"å ä½ç¬¦
- [ ] ä¸Šä¸‹æ–‡æ³¨å…¥åè„±æ•

---

**åˆ›å»ºæ—¥æœŸ**: 2026-01-27  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: å¾…æ‰§è¡Œ
