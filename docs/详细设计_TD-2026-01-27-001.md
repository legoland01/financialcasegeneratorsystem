# v2.0 è¯¦ç»†è®¾è®¡æ–¹æ¡ˆ

**æ–‡æ¡£ç¼–å·**: TD-2026-01-27-001
**ç‰ˆæœ¬**: v1.2
**æ—¥æœŸ**: 2026-01-28
**çŠ¶æ€**: å·²è¯„å®¡ï¼ˆv1.2æ¶æ„æ›´æ–°ï¼Œéƒ¨åˆ†ç»„ä»¶ç»†èŠ‚å¾…åŒæ­¥ï¼‰
**åŸºäºéœ€æ±‚**: PRODUCT_REQUIREMENTS.md v2.0 + RFC-2026-01-27-001

> **v1.2è¯´æ˜**: æ¶æ„è®¾è®¡å·²æ›´æ–°ä»¥åæ˜ å®é™…å®ç°ã€‚æ ¸å¿ƒç»„ä»¶ï¼ˆStage0Serviceã€Stage1Serviceã€PDFGeneratorSimpleï¼‰å·²æ›´æ–°ã€‚ç¬¬ä¸‰ç« "æ ¸å¿ƒç»„ä»¶è¯¦ç»†è®¾è®¡"ä¸­çš„éƒ¨åˆ†ä»£ç ç¤ºä¾‹å¯èƒ½éœ€è¦è¿›ä¸€æ­¥åŒæ­¥ã€‚

---

## æ–‡æ¡£å˜æ›´å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|---------|------|
| v1.0 | 2026-01-27 | åˆå§‹ç‰ˆæœ¬ | OpenCode AI |
| v1.1 | 2026-01-28 | 1. æ›´æ–°å…¥å£è„šæœ¬ä¸º run_complete.py<br>2. æ–°å¢è‡ªåŠ¨éªŒè¯ç³»ç»Ÿ QualityValidator<br>3. æ–°å¢æ¢è¡Œæ ¼å¼éªŒè¯<br>4. æ–°å¢ç»Ÿä¸€å…¥å£ç‚¹ç« èŠ‚<br>5. æ›´æ–°æµ‹è¯•å‘½ä»¤ | OpenCode AI |
| v1.2 | 2026-01-28 | 1. æ›´æ–°æ¶æ„å›¾ï¼šDataGeneratorâ†’Stage0Service<br>2. æ›´æ–°æ•°æ®æµå›¾<br>3. ç§»é™¤CacheManagerï¼ˆä½¿ç”¨outputsç›®å½•ï¼‰<br>4. DynamicPromptBuilderâ†’LLMç›´æ¥ç”Ÿæˆ<br>5. EvidenceRendererâ†’PDFGeneratorSimple<br>6. æ–°å¢QualityValidatorã€LLMClientç»„ä»¶<br>7. æ›´æ–°éªŒæ”¶æ ‡å‡† | OpenCode AI |

---

## ä¸€ã€ç³»ç»Ÿæ¶æ„

### 1.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç”¨æˆ·æ¥å£å±‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  run_complete.py                          # ç»Ÿä¸€å…¥å£è„šæœ¬ âœ… æ¨è              â”‚
â”‚  â”œâ”€â”€ --verify                             # ä»…éªŒè¯æ¨¡å¼                        â”‚
â”‚  â”œâ”€â”€ --stage0                             # ä»…Stage0                          â”‚
â”‚  â”œâ”€â”€ --stage1                             # Stage0+Stage1                     â”‚
â”‚  â””â”€â”€ --stage2                             # Stage0+Stage1+PDF                 â”‚
â”‚                                                                              â”‚
â”‚  validate_outputs.py                      # ç‹¬ç«‹éªŒè¯è„šæœ¬ï¼ˆä¿ç•™ï¼‰               â”‚
â”‚                                                                              â”‚
â”‚  run_full_regeneration.py                 # âš ï¸ å·²åºŸå¼ƒï¼ˆä»ä¿ç•™ï¼‰               â”‚
â”‚  generate_pdf.py                          # âš ï¸ å·²åºŸå¼ƒï¼ˆä»ä¿ç•™ï¼‰               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              æ ¸å¿ƒå¤„ç†å±‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Stage0Service                                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚LLMClient    â”‚  â”‚Stage0Tasks                                    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - APIè°ƒç”¨   â”‚  â”‚ - 0.1 ç»“æ„åŒ–æå–                              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - è¶…æ—¶æ§åˆ¶  â”‚  â”‚ - 0.2 è„±æ•è®¡åˆ’                                â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - é”™è¯¯é‡è¯•  â”‚  â”‚ - 0.3 äº¤æ˜“é‡æ„                                â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ - 0.4 å…³é”®æ•°å­—                                â”‚   â”‚    â”‚
â”‚  â”‚                   â”‚ - 0.5 è¯æ®è§„åˆ’                                â”‚   â”‚    â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Stage1Service                                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚LLMClient    â”‚  â”‚Stage1Tasks                                    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - APIè°ƒç”¨   â”‚  â”‚ - 1.1 èµ·è¯‰çŠ¶ç”Ÿæˆ                              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - è¶…æ—¶æ§åˆ¶  â”‚  â”‚ - 1.2 è¯æ®åŒ…ç”Ÿæˆï¼ˆLLMç›´æ¥ç”Ÿæˆï¼‰              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - é”™è¯¯é‡è¯•  â”‚  â”‚ - 1.3 ç¨‹åºæ–‡ä»¶ç”Ÿæˆ                            â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  ç‰¹ç‚¹ï¼šè¯æ®å†…å®¹ç”±LLMæ ¹æ®Promptç›´æ¥ç”Ÿæˆï¼Œéç¨‹åºç”Ÿæˆ                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     PDFGeneratorSimple                               â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚SimpleDocTemplateâ”‚  â”‚Styles                                    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - é¡µé¢å¸ƒå±€      â”‚  â”‚ - ChineseTitle                           â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - åˆ†é¡µæ§åˆ¶      â”‚  â”‚ - ChineseBody                            â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ - å…ƒç´ æµ        â”‚  â”‚ - EvidenceTitle                          â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  ç‰¹ç‚¹ï¼šç›´æ¥è¯»å–outputsç›®å½•çš„è¯æ®æ–‡ä»¶è¿›è¡ŒPDFæ¸²æŸ“                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     QualityValidator                                  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  - è„±æ•æ ‡è®°æ£€æŸ¥ï¼ˆæŸæŸã€XXXXç­‰ï¼‰                                       â”‚    â”‚
â”‚  â”‚  - Markdownè¡¨æ ¼æ£€æŸ¥                                                  â”‚    â”‚
â”‚  â”‚  - æ¢è¡Œæ ¼å¼æ£€æŸ¥ï¼ˆåˆåŒæ¡æ¬¾å¼•ç”¨å®Œæ•´æ€§ï¼‰                                 â”‚    â”‚
â”‚  â”‚  - æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆè®¾å¤‡é‡‘é¢=åˆåŒé‡‘é¢ï¼‰                                â”‚    â”‚
â”‚  â”‚  - è¯æ®å®Œæ•´æ€§æ£€æŸ¥                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              æ•°æ®å­˜å‚¨å±‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  outputs/                                                                    â”‚
â”‚  â”œâ”€â”€ stage0/                              # Stage 0 äº§ç‰©                     â”‚
â”‚  â”‚   â”œâ”€â”€ 0.1_structured_extraction.json                                   â”‚
â”‚  â”‚   â”œâ”€â”€ 0.2_anonymization_plan.json                                      â”‚
â”‚  â”‚   â”œâ”€â”€ 0.3_transaction_reconstruction.json                               â”‚
â”‚  â”‚   â””â”€â”€ 0.4_key_numbers.json            # æ ¸å¿ƒæ•°æ®æ–‡ä»¶                     â”‚
â”‚  â”‚                                                                      â”‚
â”‚  outputs_complete/                        # å®Œæ•´å·å®—                         â”‚
â”‚  â”œâ”€â”€ åŸå‘Šèµ·è¯‰åŒ…/                                                             â”‚
â”‚  â”‚   â”œâ”€â”€ æ°‘äº‹èµ·è¯‰çŠ¶.txt                                                   â”‚
â”‚  â”‚   â”œâ”€â”€ key_numbers.json                                               â”‚
â”‚  â”‚   â”œâ”€â”€ evidence_index.json                                             â”‚
â”‚  â”‚   â””â”€â”€ è¯æ®ç»„1-6/                                                      â”‚
â”‚  â”œâ”€â”€ è¢«å‘Šç­”è¾©åŒ…/                                                             â”‚
â”‚  â”œâ”€â”€ æ³•é™¢å®¡ç†åŒ…/                                                             â”‚
â”‚  â””â”€â”€ å®Œæ•´æµ‹è¯•å·å®—.pdf                    # æœ€ç»ˆPDF                          â”‚
â”‚                                                                      â”‚
â”‚  config/                                # é…ç½®                             â”‚
â”‚  â”œâ”€â”€ case_types/                                                             â”‚
â”‚  â”‚   â””â”€â”€ financing_lease.json                                              â”‚
â”‚  â””â”€â”€ prompts/                           # LLM Promptæ¨¡æ¿                   â”‚
â”‚       â”œâ”€â”€ stage0/                                                            â”‚
â”‚       â””â”€â”€ stage1/                                                            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ•°æ®æµå›¾ï¼ˆv1.2æ›´æ–°ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å…¥é˜¶æ®µ                                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  åŸå§‹åˆ¤å†³ä¹¦æ–‡ä»¶ï¼ˆPDFï¼‰                                                        â”‚
â”‚      â†“                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Stage0Service - LLMç»“æ„åŒ–æå–                                           â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  0.1 ç»“æ„åŒ–æå–: æå–å½“äº‹äººã€é‡‘é¢ã€æ—¥æœŸç­‰                              â”‚  â”‚
â”‚  â”‚  0.2 è„±æ•è®¡åˆ’: ç”Ÿæˆå…¬å¸Profileåº“                                       â”‚  â”‚
â”‚  â”‚  0.3 äº¤æ˜“é‡æ„: åˆ†æèèµ„ç§Ÿèµäº¤æ˜“ç»“æ„                                    â”‚  â”‚
â”‚  â”‚  0.4 å…³é”®æ•°å­—: æå–ç§Ÿèµç‰©æ¸…å•ã€æŠµæŠ¼ç‰©æ¸…å•ã€ç§Ÿé‡‘è®¡åˆ’                    â”‚  â”‚
â”‚  â”‚  0.5 è¯æ®è§„åˆ’: è§„åˆ’è¯æ®ç»„å’Œè¯æ®å½’å±                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â†“                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è¾¹ç•Œæ¡ä»¶ (Boundary Conditions)                                         â”‚  â”‚
â”‚  â”‚    æ¥è‡ªLLMä»åˆ¤å†³ä¹¦ç›´æ¥æå–ï¼Œéé¢„è®¾æ¨¡æ¿                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯æ®ç”Ÿæˆé˜¶æ®µ                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Stage1Service - LLMç›´æ¥ç”Ÿæˆè¯æ®å†…å®¹                                     â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  1.1 èµ·è¯‰çŠ¶ç”Ÿæˆ: æ ¹æ®è¾¹ç•Œæ¡ä»¶ç”Ÿæˆæ°‘äº‹èµ·è¯‰çŠ¶                            â”‚  â”‚
â”‚  â”‚  1.2 è¯æ®åŒ…ç”Ÿæˆ: LLMæ ¹æ®Promptç›´æ¥ç”Ÿæˆè¯æ®å†…å®¹ï¼ˆæ ¸å¿ƒåˆ›æ–°ç‚¹ï¼‰           â”‚  â”‚
â”‚  â”‚  1.3 ç¨‹åºæ–‡ä»¶ç”Ÿæˆ: ç”Ÿæˆé€è¾¾å›è¯ã€è¯‰è®¼è´¹æ”¶æ®ç­‰                          â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  å…³é”®è®¾è®¡: è¯æ®å†…å®¹ç”±LLMç”Ÿæˆï¼Œéç¨‹åºç”Ÿæˆ                               â”‚  â”‚
â”‚  â”‚  - PromptåŒ…å«å®Œæ•´è¾¹ç•Œæ¡ä»¶å’Œå…¬å¸Profile                                  â”‚  â”‚
â”‚  â”‚  - LLMç”ŸæˆçœŸå®å…¬å¸åç§°ã€åœ°å€ã€é‡‘é¢ç­‰                                   â”‚  â”‚
â”‚  â”‚  - è¾“å‡ºæ ¼å¼: çº¯æ–‡æœ¬ï¼ˆå¸¦æ¢è¡Œæ ¼å¼ï¼‰                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â†“                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ä¿å­˜åˆ° outputs/stage1/evidence/                                        â”‚  â”‚
â”‚  â”‚    - è¯æ®ç»„1-5/*.txt                                                   â”‚  â”‚
â”‚  â”‚    - evidence_index.json                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PDFæ¸²æŸ“é˜¶æ®µ                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PDFGeneratorSimple                                                     â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  - è¯»å– outputs/stage1/evidence/ çš„è¯æ®æ–‡ä»¶                           â”‚  â”‚
â”‚  â”‚  - è¯»å– outputs/stage0/0.4_key_numbers.json                           â”‚  â”‚
â”‚  â”‚  - ä½¿ç”¨ SimpleDocTemplate æ¸²æŸ“PDF                                     â”‚  â”‚
â”‚  â”‚  - æ”¯æŒä¸­æ–‡å­—ä½“ï¼ˆPingFang/STHeitiï¼‰                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â†“                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è¾“å‡º: outputs_complete/å®Œæ•´æµ‹è¯•å·å®—.pdf                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éªŒè¯é˜¶æ®µ                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ QualityValidator - è‡ªåŠ¨éªŒè¯                                            â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  - è„±æ•æ ‡è®°æ£€æŸ¥: æ£€æŸ¥æŸæŸã€XXXXç­‰                                       â”‚  â”‚
â”‚  â”‚  - Markdownè¡¨æ ¼æ£€æŸ¥: æ£€æŸ¥| :---|æ ¼å¼                                   â”‚  â”‚
â”‚  â”‚  - æ¢è¡Œæ ¼å¼æ£€æŸ¥: æ£€æŸ¥åˆåŒæ¡æ¬¾å¼•ç”¨å®Œæ•´æ€§                                â”‚  â”‚
â”‚  â”‚  - æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥: è®¾å¤‡é‡‘é¢=åˆåŒé‡‘é¢                                   â”‚  â”‚
â”‚  â”‚  - è¯æ®å®Œæ•´æ€§æ£€æŸ¥: è¯æ®æ•°é‡å’Œå†…å®¹                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 7. æ„å»ºPrompt                                                           â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  # ä»»åŠ¡ï¼šç”Ÿæˆèèµ„ç§ŸèµåˆåŒ                                              â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  ## å½“äº‹äººä¿¡æ¯                                                         â”‚  â”‚
â”‚  â”‚  **ç”²æ–¹ï¼ˆå‡ºç§Ÿäººï¼‰**ï¼š                                                   â”‚  â”‚
â”‚  â”‚  - å…¬å¸åç§°ï¼šä¸œæ–¹å›½é™…èèµ„ç§Ÿèµæœ‰é™å…¬å¸  â† åè„±æ•ä¸Šä¸‹æ–‡                   â”‚  â”‚
â”‚  â”‚  ...                                                                   â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  ## æ¡ˆä»¶å…³é”®æ•°æ®                                                       â”‚  â”‚
â”‚  â”‚  - åˆåŒé‡‘é¢ï¼š150000000å…ƒ  â† è¾¹ç•Œæ¡ä»¶                                   â”‚  â”‚
â”‚  â”‚  - ç­¾è®¢æ—¥æœŸï¼š2021-02-24                                                â”‚  â”‚
â”‚  â”‚  ...                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â†“                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 8. LLMç”Ÿæˆè¯æ®                                                         â”‚  â”‚
â”‚  â”‚    - ä½¿ç”¨æ³¨å…¥çš„ä¸Šä¸‹æ–‡                                                   â”‚  â”‚
â”‚  â”‚    - ç›´æ¥ç”ŸæˆçœŸå®å†…å®¹ï¼ˆæ— å ä½ç¬¦ï¼‰                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PDFæ¸²æŸ“é˜¶æ®µ                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 9. æ¸²æŸ“PDF                                                             â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  EvidenceRenderer.render_contract()                                   â”‚  â”‚
â”‚  â”‚    - åˆåŒæ ‡é¢˜: 18å·é»‘ä½“                                                â”‚  â”‚
â”‚  â”‚    - æ­£æ–‡: 12å·å®‹ä½“                                                    â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚  EvidenceRenderer.render_table()                                      â”‚  â”‚
â”‚  â”‚    - è¡¨æ ¼æ ‡é¢˜: 14å·é»‘ä½“                                                â”‚  â”‚
â”‚  â”‚    - è¡¨å¤´: ç°åº•                                                        â”‚  â”‚
â”‚  â”‚    - æ–‘é©¬çº¹                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â†“                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 10. æ™ºèƒ½åˆ†é¡µ                                                           â”‚  â”‚
â”‚  â”‚    - æ¯ä»½è¯æ®å¦èµ·ä¸€é¡µ                                                  â”‚  â”‚
â”‚  â”‚    - é¡µç è¿ç»­                                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å‡ºé˜¶æ®µ                                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  outputs/                                                                    â”‚
â”‚  â”œâ”€â”€ å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf           # æœ€ç»ˆPDF                            â”‚
â”‚  â”œâ”€â”€ è¯æ®ç´¢å¼•.json                     # è¯æ®æ¸…å•                           â”‚
â”‚  â””â”€â”€ è¯æ®æ–‡ä»¶/                                                              â”‚
â”‚      â”œâ”€â”€ E001_èèµ„ç§ŸèµåˆåŒ.txt                                              â”‚
â”‚      â”œâ”€â”€ E002_ç§Ÿèµç‰©æ¸…å•.txt                                              â”‚
â”‚      â””â”€â”€ E003_ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’.txt                                             â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æ ¸å¿ƒæ•°æ®ç»“æ„è®¾è®¡

### 2.1 è¾¹ç•Œæ¡ä»¶ (BoundaryConditions)

```json
{
  "boundary_conditions": {
    "åˆåŒé‡‘é¢": 150000000,
    "åˆ©ç‡": 0.061,
    "ç­¾è®¢æ—¥æœŸ": "2021-02-24",
    "è®¾å¤‡æ•°é‡": 62,
    "ç§ŸèµæœŸ": 24,
    "å½“äº‹äºº": {
      "å‡ºç§Ÿäºº": "æŸæŸå…¬å¸5",
      "æ‰¿ç§Ÿäºº": "æŸæŸå…¬å¸1",
      "æ‹…ä¿äºº": "æŸæŸå…¬å¸6"
    },
    "æ•°æ®æ¥æº": "åˆ¤å†³ä¹¦",
    "æµ‹è¯•æ ‡è®°": null
  }
}
```

### 2.2 è¯¦ç»†æ•°æ® (DetailedData)

```json
{
  "è¯¦ç»†æ•°æ®": {
    "ç§Ÿèµç‰©æ¸…å•": [
      {
        "åºå·": 1,
        "è®¾å¤‡åç§°": "å¤šè”æœºä¸­å¤®ç©ºè°ƒç³»ç»Ÿ",
        "è§„æ ¼å‹å·": "VRV VIIIä»£",
        "æ•°é‡": "10å¥—",
        "å­˜æ”¾åœ°ç‚¹": "å—æ˜Œå¸‚çº¢è°·æ»©åŒºXXå¹¿åœº",
        "è¯„ä¼°ä»·å€¼": 50000000,
        "æ•°æ®æ¥æº": "æ¨¡æ¿ç”Ÿæˆ"
      }
    ],
    "ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’": [
      {
        "æœŸæ•°": 1,
        "åº”ä»˜æ—¥æœŸ": "2021-05-24",
        "ç§Ÿé‡‘é‡‘é¢": 19455520.96,
        "æœ¬é‡‘é‡‘é¢": 12788854.29,
        "åˆ©æ¯é‡‘é¢": 6666666.67,
        "æ”¯ä»˜çŠ¶æ€": "å·²ä»˜"
      }
    ],
    "é“¶è¡Œè´¦æˆ·": {
      "å‡ºç§Ÿäºº": {
        "å¼€æˆ·è¡Œ": "ä¸­å›½å·¥å•†é“¶è¡Œä¸Šæµ·æµ¦ä¸œåˆ†è¡Œ",
        "è´¦å·": "1502211009191234567"
      },
      "æ‰¿ç§Ÿäºº": {
        "å¼€æˆ·è¡Œ": "ä¸­å›½å·¥å•†é“¶è¡Œå—æ˜Œçº¢è°·æ»©åˆ†è¡Œ",
        "è´¦å·": "1502211009191234568"
      }
    }
  }
}
```

### 2.3 åè„±æ•ä¸Šä¸‹æ–‡ (DeanonymizationContext)

```json
{
  "åè„±æ•ä¸Šä¸‹æ–‡": {
    "å…¬å¸Profileåº“": {
      "æŸæŸå…¬å¸5": {
        "å…¬å¸åç§°": "ä¸œæ–¹å›½é™…èèµ„ç§Ÿèµæœ‰é™å…¬å¸",
        "ä¿¡ç”¨ä»£ç ": "91310000MA1FL3L123",
        "æ³•å®šä»£è¡¨äºº": "å‘¨æ˜è¿œ",
        "æ³¨å†Œåœ°å€": "ä¸­å›½ï¼ˆä¸Šæµ·ï¼‰è‡ªç”±è´¸æ˜“è¯•éªŒåŒºä¸–çºªå¤§é“100å·",
        "è”ç³»ç”µè¯": "021-88888888"
      },
      "æŸæŸå…¬å¸1": {
        "å…¬å¸åç§°": "æ±Ÿè¥¿æ˜Œç››å•†ä¸šç®¡ç†æœ‰é™å…¬å¸",
        "ä¿¡ç”¨ä»£ç ": "91360121MA1XXXXXX",
        "æ³•å®šä»£è¡¨äºº": "å¼ ä¼Ÿ",
        "æ³¨å†Œåœ°å€": "æ±Ÿè¥¿çœå—æ˜Œå¸‚çº¢è°·æ»©åŒºXXè·¯XXå·",
        "è”ç³»ç”µè¯": "0791-88888888"
      }
    },
    "äººç‰©Profileåº“": {
      "å¼ æŸ": {
        "å§“å": "å¼ ä¼Ÿ",
        "èº«ä»½è¯": "360102197001011234"
      }
    }
  }
}
```

### 2.4 å®Œæ•´ç¼“å­˜ç»“æ„

```json
{
  "version": "2.0",
  "judgment_hash": "a1b2c3d4e5f6...",
  "judgment_path": "/path/to/judgment.txt",
  "created_at": "2026-01-27T10:00:00Z",
  "last_used": "2026-01-27T10:00:00Z",
  "boundary_conditions": {
    "åˆåŒé‡‘é¢": 150000000,
    "åˆ©ç‡": 0.061,
    "ç­¾è®¢æ—¥æœŸ": "2021-02-24",
    "è®¾å¤‡æ•°é‡": 62,
    "å½“äº‹äºº": {
      "å‡ºç§Ÿäºº": "æŸæŸå…¬å¸5",
      "æ‰¿ç§Ÿäºº": "æŸæŸå…¬å¸1"
    }
  },
  "generated_data": {
    "ç§Ÿèµç‰©æ¸…å•": [...],
    "ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’": [...],
    "é“¶è¡Œè´¦æˆ·": {...}
  },
  "deanonymization_context": {
    "å…¬å¸Profileåº“": {...},
    "äººç‰©Profileåº“": {...}
  },
  "test_config": {
    "enabled": false,
    "errors": []
  }
}
```

---

## äºŒã€å…¥å£ç‚¹è®¾è®¡ï¼ˆv1.1æ–°å¢ï¼‰

### 2.1 ç»Ÿä¸€å…¥å£è„šæœ¬ run_complete.py

`run_complete.py` æ˜¯ç³»ç»Ÿçš„ç»Ÿä¸€å…¥å£è„šæœ¬ï¼Œæ•´åˆäº†æ‰€æœ‰é˜¶æ®µçš„æ‰§è¡Œå’Œè‡ªåŠ¨éªŒè¯åŠŸèƒ½ã€‚

#### 2.1.1 å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| æ— å‚æ•° | æ‰§è¡Œå®Œæ•´æµç¨‹ï¼ˆStage0 â†’ Stage1 â†’ Stage2ï¼‰å¹¶è‡ªåŠ¨éªŒè¯ | `python3 run_complete.py` |
| `--verify` | ä»…éªŒè¯æ¨¡å¼ï¼ˆä¸é‡æ–°ç”Ÿæˆï¼‰ | `python3 run_complete.py --verify` |
| `--stage0` | ä»…æ‰§è¡Œ Stage0 | `python3 run_complete.py --stage0` |
| `--stage1` | æ‰§è¡Œ Stage0 + Stage1 | `python3 run_complete.py --stage1` |
| `--stage2` | æ‰§è¡Œ Stage0 + Stage1 + Stage2ï¼ˆPDFç”Ÿæˆï¼‰ | `python3 run_complete.py --stage2` |
| `--force` | å¼ºåˆ¶åˆ·æ–°ç¼“å­˜ | `python3 run_complete.py --force` |
| `--help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | `python3 run_complete.py --help` |

#### 2.1.2 æµç¨‹å›¾

```
run_complete.py
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                                         â”‚
     â–¼                                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage0   â”‚                                            â”‚ éªŒè¯ç³»ç»Ÿ  â”‚
â”‚ æ•°æ®ç”Ÿæˆ  â”‚                                            â”‚ Quality  â”‚
â”‚          â”‚                                            â”‚ Validatorâ”‚
â”‚ 0.1 æå–  â”‚                                            â”‚          â”‚
â”‚ 0.2 è„±æ•  â”‚                                            â”‚ è„±æ•æ£€æŸ¥  â”‚
â”‚ 0.3 äº¤æ˜“  â”‚                                            â”‚ è¡¨æ ¼æ£€æŸ¥  â”‚
â”‚ 0.4 é‡‘é¢  â”‚                                            â”‚ æ¢è¡ŒéªŒè¯  â”‚
â”‚ 0.5 è¯æ®  â”‚                                            â”‚ ä¸€è‡´æ€§   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                                         â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚    â”‚
     â–¼    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage1   â”‚
â”‚ æ–‡ä¹¦ç”Ÿæˆ  â”‚
â”‚          â”‚
â”‚ èµ·è¯‰çŠ¶    â”‚
â”‚ è¯æ®åŒ…    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage2   â”‚
â”‚ PDFç”Ÿæˆ   â”‚
â”‚          â”‚
â”‚ å®Œæ•´å·å®—  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
  è¾“å‡ºç»“æœ
```

### 2.2 åºŸå¼ƒè„šæœ¬ï¼ˆæ—§å…¥å£ï¼‰

ä»¥ä¸‹è„šæœ¬å·²åºŸå¼ƒï¼Œä½†ä»ä¿ç•™ä»¥å…¼å®¹æ—§ç‰ˆæœ¬ï¼š

| è„šæœ¬ | çŠ¶æ€ | æ›¿ä»£æ–¹æ¡ˆ |
|------|------|---------|
| `run_full_regeneration.py` | âš ï¸ åºŸå¼ƒ | ä½¿ç”¨ `run_complete.py` |
| `generate_pdf.py` | âš ï¸ åºŸå¼ƒ | ä½¿ç”¨ `run_complete.py --stage2` |
| `generate_docket.py` | âŒ æœªå®ç° | - |

> **æ³¨æ„**: ä½¿ç”¨åºŸå¼ƒè„šæœ¬æ—¶ä¼šæ˜¾ç¤º `DeprecationWarning` è­¦å‘Š

### 2.3 ç‹¬ç«‹éªŒè¯è„šæœ¬ validate_outputs.py

ç‹¬ç«‹éªŒè¯è„šæœ¬ï¼Œç”¨äºéªŒè¯å·²ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶ï¼ˆä¸é‡æ–°ç”Ÿæˆï¼‰ï¼š

```bash
# è¿è¡Œç‹¬ç«‹éªŒè¯
python3 validate_outputs.py

# è¾“å‡ºç¤ºä¾‹
======================================================================
é‡‘èæ¡ˆä»¶æµ‹è¯•æ•°æ®ç”Ÿæˆç³»ç»Ÿ - è‡ªåŠ¨éªŒè¯
======================================================================
ã€1ã€‘Stage0 æ•°æ®éªŒè¯
  âœ… è®¾å¤‡æ¸…å•: 8é¡¹
  âœ… è®¾å¤‡åˆè®¡: 150,000,000å…ƒ
  âœ… åˆåŒé‡‘é¢: 150,000,000å…ƒ
  âœ… é‡‘é¢ä¸€è‡´

ã€2ã€‘è¯æ®æ–‡ä»¶éªŒè¯
  âœ… è¯æ®æ€»æ•°: 11

ã€3ã€‘PDFéªŒè¯
  âœ… æ–‡ä»¶å­˜åœ¨: å¤§å°: 387KB
  âœ… è„±æ•æ ‡è®°: æ— è„±æ•æ ‡è®°

éªŒè¯ç»“è®º
ğŸ‰ æ‰€æœ‰éªŒè¯é€šè¿‡ï¼
```

---

## ä¸‰ã€æ ¸å¿ƒç»„ä»¶è¯¦ç»†è®¾è®¡ï¼ˆæ›´æ–°ï¼‰

### 3.1 BoundaryConditionExtractor

```python
class BoundaryConditionExtractor:
    """è¾¹ç•Œæ¡ä»¶æå–å™¨ - ä»åˆ¤å†³ä¹¦æ–‡æœ¬ç›´æ¥æå–å…³é”®æ•°æ®"""
    
    def __init__(self, llm_client=None):
        """
        åˆå§‹åŒ–è¾¹ç•Œæ¡ä»¶æå–å™¨
        
        Args:
            llm_client: LLMå®¢æˆ·ç«¯å®ä¾‹ï¼Œå¦‚æœä¸ºNoneåˆ™ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–
        """
        self.llm_client = llm_client
        
        # æ­£åˆ™è¡¨è¾¾å¼æå–æ¨¡å¼
        self.patterns = {
            'contract_amount': r'([\d,]+)\s*å…ƒ',
            'interest_rate': r'(\d+(?:\.\d+)?)\s*%',
            'signing_date': r'(\d{4})å¹´(\d{1,2})æœˆ(\d{1,2})æ—¥',
            'equipment_count': r'(\d+)\s*(?:å¥—|å°|ä»¶)',
        }
    
    def extract(self, judgment_text: str) -> dict:
        """
        ä»åˆ¤å†³ä¹¦æ–‡æœ¬æå–è¾¹ç•Œæ¡ä»¶
        
        Args:
            judgment_text: åˆ¤å†³ä¹¦åŸå§‹æ–‡æœ¬
        Returns:
            è¾¹ç•Œæ¡ä»¶å­—å…¸
        """
        if self.llm_client:
            # ä½¿ç”¨LLMç»“æ„åŒ–æå–ï¼ˆæ¨èï¼‰
            return self._extract_by_llm(judgment_text)
        else:
            # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–ï¼ˆå¤‡é€‰ï¼‰
            return self._extract_by_regex(judgment_text)
    
    def _extract_by_llm(self, judgment_text: str) -> dict:
        """
        ä½¿ç”¨LLMç»“æ„åŒ–æå–è¾¹ç•Œæ¡ä»¶
        """
        prompt = self._build_extraction_prompt(judgment_text)
        response = self.llm_client.complete(prompt)
        
        # è§£æJSONå“åº”
        try:
            # å°è¯•ç›´æ¥è§£æJSON
            boundary_conditions = json.loads(response)
        except json.JSONDecodeError:
            # ä»æ–‡æœ¬ä¸­æå–JSON
            boundary_conditions = self._parse_json_from_response(response)
        
        # éªŒè¯å¿…å¡«å­—æ®µ
        self._validate_required_fields(boundary_conditions)
        
        return boundary_conditions
    
    def _build_extraction_prompt(self, judgment_text: str) -> str:
        """æ„å»ºæå–Prompt"""
        return f"""
# ä»»åŠ¡ï¼šä»åˆ¤å†³ä¹¦ä¸­æå–å…³é”®æ•°æ®

è¯·ä»ä»¥ä¸‹åˆ¤å†³ä¹¦æ–‡æœ¬ä¸­æå–å…³é”®æ•°æ®ï¼Œä»¥JSONæ ¼å¼è¾“å‡ºã€‚

## æå–è¦æ±‚
1. åªæå–åˆ¤å†³ä¹¦ä¸­**æ˜ç¡®åˆ—å‡º**çš„æ•°æ®
2. å¦‚æœæŸé¡¹æ•°æ®åˆ¤å†³ä¹¦æ²¡æœ‰æåŠï¼Œæ ‡è®°ä¸ºnull
3. é‡‘é¢ä½¿ç”¨æ•°å­—æ ¼å¼ï¼ˆå•ä½ï¼šå…ƒï¼‰
4. æ—¥æœŸä½¿ç”¨YYYY-MM-DDæ ¼å¼

## æå–å­—æ®µ
- contract_amount: åˆåŒé‡‘é¢ï¼ˆæ•°å­—ï¼‰
- interest_rate: å¹´åˆ©ç‡ï¼ˆå°æ•°ï¼Œå¦‚0.061è¡¨ç¤º6.1%ï¼‰
- signing_date: ç­¾è®¢æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
- equipment_count: è®¾å¤‡æ•°é‡ï¼ˆæ•°å­—ï¼‰
- lessor_marker: å‡ºç§Ÿäººè„±æ•æ ‡è¯†ï¼ˆå¦‚"æŸæŸå…¬å¸5"ï¼‰
- lessee_marker: æ‰¿ç§Ÿäººè„±æ•æ ‡è¯†ï¼ˆå¦‚"æŸæŸå…¬å¸1"ï¼‰
- guarantor_marker: æ‹…ä¿äººè„±æ•æ ‡è¯†ï¼ˆå¦‚æœ‰ï¼‰

## åˆ¤å†³ä¹¦æ–‡æœ¬
{judgment_text}

## è¾“å‡ºæ ¼å¼
```json
{{
  "contract_amount": 150000000,
  "interest_rate": 0.061,
  "signing_date": "2021-02-24",
  "equipment_count": 62,
  "lessor_marker": "æŸæŸå…¬å¸5",
  "lessee_marker": "æŸæŸå…¬å¸1",
  "guarantor_marker": null,
  "data_source": "åˆ¤å†³ä¹¦æ–‡æœ¬"
}}
```
"""
    
    def _extract_by_regex(self, judgment_text: str) -> dict:
        """
        ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–è¾¹ç•Œæ¡ä»¶ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰
        """
        boundary_conditions = {
            "contract_amount": self._extract_amount(judgment_text),
            "interest_rate": self._extract_interest_rate(judgment_text),
            "signing_date": self._extract_date(judgment_text),
            "equipment_count": self._extract_equipment_count(judgment_text),
            "data_source": "æ­£åˆ™è¡¨è¾¾å¼æå–"
        }
        
        # æå–å½“äº‹äººæ ‡è®°ï¼ˆéœ€è¦æ›´å¤æ‚çš„æ¨¡å¼åŒ¹é…ï¼‰
        party_markers = self._extract_party_markers(judgment_text)
        boundary_conditions.update(party_markers)
        
        return boundary_conditions
    
    def _extract_amount(self, text: str) -> Optional[float]:
        """æå–åˆåŒé‡‘é¢"""
        import re
        match = re.search(self.patterns['contract_amount'], text)
        if match:
            amount_str = match.group(1).replace(',', '')
            return float(amount_str)
        return None
    
    def _extract_interest_rate(self, text: str) -> Optional[float]:
        """æå–åˆ©ç‡"""
        import re
        match = re.search(self.patterns['interest_rate'], text)
        if match:
            rate_str = match.group(1)
            return float(rate_str) / 100  # è½¬æ¢ä¸ºå°æ•°
        return None
    
    def _extract_date(self, text: str) -> Optional[str]:
        """æå–æ—¥æœŸ"""
        import re
        match = re.search(self.patterns['signing_date'], text)
        if match:
            year, month, day = match.groups()
            return f"{year}-{int(month):02d}-{int(day):02d}"
        return None
    
    def _extract_equipment_count(self, text: str) -> Optional[int]:
        """æå–è®¾å¤‡æ•°é‡"""
        import re
        match = re.search(self.patterns['equipment_count'], text)
        if match:
            return int(match.group(1))
        return None
    
    def _extract_party_markers(self, text: str) -> dict:
        """æå–å½“äº‹äººè„±æ•æ ‡è¯†"""
        # éœ€è¦æ ¹æ®å…·ä½“æ ¼å¼å®ç°
        return {
            "lessor_marker": None,
            "lessee_marker": None,
            "guarantor_marker": None
        }
    
    def _validate_required_fields(self, data: dict):
        """éªŒè¯å¿…å¡«å­—æ®µ"""
        required = ['contract_amount', 'interest_rate', 'signing_date']
        for field in required:
            if field not in data:
                raise ValueError(f"ç¼ºå°‘å¿…å¡«å­—æ®µ: {field}")
    
    def _parse_json_from_response(self, response: str) -> dict:
        """ä»LLMå“åº”ä¸­è§£æJSON"""
        import re
        # å°è¯•åŒ¹é…JSONå—
        json_match = re.search(r'```json\s*\n(.+?)\n```', response, re.DOTALL)
        if json_match:
            return json.loads(json_match.group(1))
        
        # å°è¯•åŒ¹é…æ™®é€šJSON
        json_match = re.search(r'\{.+\}', response, re.DOTALL)
        if json_match:
            return json.loads(json_match.group(0))
        
        raise ValueError("æ— æ³•è§£æJSONå“åº”")
```

### 3.2 CacheManagerï¼ˆæ›´æ–°ï¼Œå«æ¸…ç†ç­–ç•¥ï¼‰

```python
import os
import time
from pathlib import Path
from datetime import datetime, timedelta
import json
import hashlib
import threading


class CacheManager:
    """ç¼“å­˜ç®¡ç†å™¨ - è´Ÿè´£æ•°æ®çš„ç¼“å­˜ã€è¯»å–å’Œæ¸…ç†"""
    
    def __init__(
        self,
        cache_dir: str = "cache",
        max_cache_days: int = 30,
        max_cache_count: int = 100
    ):
        """
        åˆå§‹åŒ–ç¼“å­˜ç®¡ç†å™¨
        
        Args:
            cache_dir: ç¼“å­˜ç›®å½•
            max_cache_days: ç¼“å­˜æœ€å¤§ä¿ç•™å¤©æ•°ï¼ˆé»˜è®¤30å¤©ï¼‰
            max_cache_count: ç¼“å­˜æœ€å¤§æ•°é‡ï¼ˆé»˜è®¤100ä¸ªï¼‰
        """
        self.cache_dir = Path(cache_dir)
        self.cache_dir.mkdir(exist_ok=True)
        
        self.cache_index_path = self.cache_dir / "cache_index.json"
        self.max_cache_days = max_cache_days
        self.max_cache_count = max_cache_count
        
        # çº¿ç¨‹é”ï¼ˆé˜²æ­¢å¹¶å‘å†™å…¥å†²çªï¼‰
        self._lock = threading.Lock()
        
        # åŠ è½½ç¼“å­˜ç´¢å¼•
        self._load_index()
    
    def get_cache_key(self, judgment_path: str) -> str:
        """è®¡ç®—åˆ¤å†³ä¹¦æ–‡ä»¶çš„å“ˆå¸Œå€¼ä½œä¸ºç¼“å­˜é”®"""
        hash_sha256 = hashlib.sha256()
        try:
            with open(judgment_path, "rb") as f:
                for chunk in iter(lambda: f.read(8192), b""):
                    hash_sha256.update(chunk)
        except FileNotFoundError:
            # å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨æ–‡ä»¶è·¯å¾„çš„å“ˆå¸Œ
            hash_sha256.update(judgment_path.encode('utf-8'))
        
        return hash_sha256.hexdigest()
    
    def get(self, judgment_path: str, force_refresh: bool = False) -> Optional[dict]:
        """
        è·å–ç¼“å­˜æ•°æ®
        
        Args:
            judgment_path: åˆ¤å†³ä¹¦æ–‡ä»¶è·¯å¾„
            force_refresh: æ˜¯å¦å¼ºåˆ¶åˆ·æ–°
        Returns:
            ç¼“å­˜æ•°æ®æˆ–Noneï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
        """
        cache_key = self.get_cache_key(judgment_path)
        cache_file = self.cache_dir / f"{cache_key}.json"
        
        # æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨
        if cache_file.exists() and not force_refresh:
            try:
                with open(cache_file, 'r', encoding='utf-8') as f:
                    cache_data = json.load(f)
                
                # æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸ
                if self._is_expired(cache_data):
                    self._remove_expired_cache(cache_file, cache_key)
                    return None
                
                # æ›´æ–°æœ€åä½¿ç”¨æ—¶é—´
                cache_data['last_used'] = datetime.utcnow().isoformat()
                with open(cache_file, 'w', encoding='utf-8') as f:
                    json.dump(cache_data, f, ensure_ascii=False, indent=2)
                
                return cache_data
            except (json.JSONDecodeError, KeyError):
                # ç¼“å­˜æ–‡ä»¶æŸåï¼Œåˆ é™¤å¹¶é‡æ–°ç”Ÿæˆ
                cache_file.unlink()
        
        return None
    
    def save(self, judgment_path: str, data: dict) -> str:
        """
        ä¿å­˜æ•°æ®åˆ°ç¼“å­˜
        
        Args:
            judgment_path: åˆ¤å†³ä¹¦æ–‡ä»¶è·¯å¾„
            data: è¦ç¼“å­˜çš„æ•°æ®
        Returns:
            cache_key
        """
        cache_key = self.get_cache_key(judgment_path)
        cache_file = self.cache_dir / f"{cache_key}.json"
        
        with self._lock:
            # æ·»åŠ å…ƒæ•°æ®
            data["version"] = "2.0"
            data["judgment_hash"] = cache_key
            data["judgment_path"] = judgment_path
            data["created_at"] = datetime.utcnow().isoformat()
            data["last_used"] = datetime.utcnow().isoformat()
            
            # ä¿å­˜ç¼“å­˜æ–‡ä»¶
            with open(cache_file, 'w', encoding='utf-8') as f:
                json.dump(data, f, ensure_ascii=False, indent=2)
            
            # æ›´æ–°ç´¢å¼•
            self._update_index(cache_key, cache_file)
            
            # æ£€æŸ¥æ˜¯å¦éœ€è¦æ¸…ç†
            self._cleanup_if_needed()
        
        return cache_key
    
    def _load_index(self):
        """åŠ è½½ç¼“å­˜ç´¢å¼•"""
        if self.cache_index_path.exists():
            try:
                with open(self.cache_index_path, 'r', encoding='utf-8') as f:
                    self.index = json.load(f)
            except json.JSONDecodeError:
                self.index = {}
        else:
            self.index = {}
    
    def _update_index(self, cache_key: str, cache_file: Path):
        """æ›´æ–°ç¼“å­˜ç´¢å¼•"""
        self.index[cache_key] = {
            "file": str(cache_file),
            "created_at": datetime.utcnow().isoformat()
        }
        
        with open(self.cache_index_path, 'w', encoding='utf-8') as f:
            json.dump(self.index, f, ensure_ascii=False, indent=2)
    
    def _is_expired(self, cache_data: dict) -> bool:
        """æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸ"""
        created_at = cache_data.get('created_at')
        if not created_at:
            return False
        
        try:
            created_date = datetime.fromisoformat(created_at)
            expiry_date = created_date + timedelta(days=self.max_cache_days)
            return datetime.now() > expiry_date
        except (ValueError, TypeError):
            return False
    
    def _remove_expired_cache(self, cache_file: Path, cache_key: str):
        """åˆ é™¤è¿‡æœŸç¼“å­˜"""
        try:
            cache_file.unlink()
            if cache_key in self.index:
                del self.index[cache_key]
            with open(self.cache_index_path, 'w', encoding='utf-8') as f:
                json.dump(self.index, f, ensure_ascii=False, indent=2)
        except Exception:
            pass
    
    def _cleanup_if_needed(self):
        """å¦‚æœéœ€è¦ï¼Œæ¸…ç†ç¼“å­˜"""
        # æ£€æŸ¥æ•°é‡é™åˆ¶
        if len(self.index) > self.max_cache_count:
            self._cleanup_by_count()
        
        # æ£€æŸ¥è¿‡æœŸç¼“å­˜
        self._cleanup_expired()
    
    def _cleanup_by_count(self):
        """æŒ‰æ•°é‡æ¸…ç†ï¼ˆåˆ é™¤æœ€æ—§çš„ç¼“å­˜ï¼‰"""
        # æŒ‰åˆ›å»ºæ—¶é—´æ’åº
        sorted_items = sorted(
            self.index.items(),
            key=lambda x: x[1].get('created_at', '')
        )
        
        # åˆ é™¤æœ€æ—§çš„ç¼“å­˜
        items_to_delete = len(self.index) - self.max_cache_count + 10
        for cache_key, cache_info in sorted_items[:items_to_delete]:
            try:
                cache_file = Path(cache_info['file'])
                if cache_file.exists():
                    cache_file.unlink()
                del self.index[cache_key]
            except Exception:
                pass
    
    def _cleanup_expired(self):
        """æ¸…ç†æ‰€æœ‰è¿‡æœŸç¼“å­˜"""
        expired_keys = []
        for cache_key, cache_info in self.index.items():
            cache_file = Path(cache_info['file'])
            if cache_file.exists():
                try:
                    with open(cache_file, 'r', encoding='utf-8') as f:
                        cache_data = json.load(f)
                    if self._is_expired(cache_data):
                        expired_keys.append(cache_key)
                except Exception:
                    expired_keys.append(cache_key)
        
        for cache_key in expired_keys:
            self._remove_expired_cache(
                self.index[cache_key].get('file') or cache_key,
                cache_key
            )
    
    def clear_all(self):
        """æ¸…ç†æ‰€æœ‰ç¼“å­˜"""
        with self._lock:
            for cache_key, cache_info in self.index.items():
                try:
                    cache_file = Path(cache_info['file'])
                    if cache_file.exists():
                        cache_file.unlink()
                except Exception:
                    pass
            
            self.index = {}
            if self.cache_index_path.exists():
                self.cache_index_path.unlink()
    
    def clear_by_hash(self, cache_key: str):
        """æ¸…ç†æŒ‡å®šç¼“å­˜"""
        with self._lock:
            if cache_key in self.index:
                try:
                    cache_file = Path(self.index[cache_key]['file'])
                    if cache_file.exists():
                        cache_file.unlink()
                except Exception:
                    pass
                del self.index[cache_key]
                
                with open(self.cache_index_path, 'w', encoding='utf-8') as f:
                    json.dump(self.index, f, ensure_ascii=False, indent=2)
```

### 3.3 TestConfigInjectorï¼ˆæ–°å¢ï¼‰

```python
class TestConfigInjector:
    """æµ‹è¯•é…ç½®æ³¨å…¥å™¨ - ç”¨äºé”™è¯¯æ³¨å…¥æµ‹è¯•"""
    
    def __init__(self):
        """åˆå§‹åŒ–æµ‹è¯•é…ç½®æ³¨å…¥å™¨"""
        pass
    
    def apply(
        self,
        data: dict,
        test_config: Optional[dict] = None
    ) -> dict:
        """
        åº”ç”¨æµ‹è¯•é…ç½®ï¼ˆé”™è¯¯æ³¨å…¥ï¼‰
        
        Args:
            data: åŸå§‹æ•°æ®
            test_config: æµ‹è¯•é…ç½®
                {
                    "enabled": true,
                    "description": "æµ‹è¯•æè¿°",
                    "errors": [
                        {
                            "target": "boundary_conditions.åˆåŒé‡‘é¢",
                            "operation": "multiply",  // multiply, add, replace
                            "value": 1.1  // æ“ä½œå€¼
                        }
                    ]
                }
        Returns:
            ä¿®æ”¹åçš„æ•°æ®
        """
        if not test_config or not test_config.get('enabled', False):
            return data
        
        result = self._deep_copy(data)
        
        for error in test_config.get('errors', []):
            target = error.get('target')
            operation = error.get('operation')
            value = error.get('value')
            
            if target and operation:
                self._apply_error(result, target, operation, value)
        
        return result

### 3.4 QualityValidatorï¼ˆv1.1æ–°å¢ï¼‰

```python
class QualityValidator:
    """è´¨é‡éªŒè¯å™¨ - è‡ªåŠ¨éªŒè¯ç”Ÿæˆè¾“å‡ºçš„è´¨é‡"""

    def __init__(self):
        self.issues = []
        self.warnings = []

    def validate_all(self, outputs_dir: str = "outputs") -> dict:
        """
        æ‰§è¡Œå®Œæ•´éªŒè¯

        Returns:
            éªŒè¯ç»“æœå­—å…¸
        """
        results = {
            "passed": True,
            "issues": [],
            "warnings": [],
            "details": {}
        }

        # 1. éªŒè¯Stage0æ•°æ®
        results["stage0"] = self._validate_stage0(outputs_dir)

        # 2. éªŒè¯è¯æ®æ–‡ä»¶
        results["evidence"] = self._validate_evidence(outputs_dir)

        # 3. æ±‡æ€»ç»“æœ
        results["passed"] = all([
            results["stage0"].get("passed", False),
            results["evidence"].get("passed", False)
        ])

        return results

    def _validate_stage0(self, outputs_dir: str) -> dict:
        """éªŒè¯Stage0äº§ç‰©"""
        result = {"passed": True, "issues": []}
        stage0_dir = Path(outputs_dir) / "stage0"

        # è¯»å–å…³é”®é‡‘é¢æ¸…å•
        key_numbers_path = stage0_dir / "0.4_key_numbers.json"
        if key_numbers_path.exists():
            data = json.loads(key_numbers_path.read_text())

            # æ£€æŸ¥è®¾å¤‡æ¸…å•
            rental = data.get('ç§Ÿèµç‰©æ¸…å•', [])
            if len(rental) == 0:
                result["issues"].append("è®¾å¤‡æ¸…å•ä¸ºç©º")
                result["passed"] = False

            # æ£€æŸ¥æŠµæŠ¼ç‰©æ¸…å•
            collateral = data.get('æŠµæŠ¼ç‰©æ¸…å•', [])
            if len(collateral) == 0:
                result["issues"].append("æŠµæŠ¼ç‰©æ¸…å•ä¸ºç©º")

            # æ£€æŸ¥ç§Ÿé‡‘è®¡åˆ’
            rent_plan = data.get('ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’', [])
            if len(rent_plan) < 12:
                result["issues"].append(f"ç§Ÿé‡‘è®¡åˆ’ä¸å®Œæ•´: {len(rent_plan)}æœŸ")

        else:
            result["issues"].append("0.4_key_numbers.json ä¸å­˜åœ¨")
            result["passed"] = False

        return result

    def _validate_evidence(self, outputs_dir: str) -> dict:
        """éªŒè¯è¯æ®æ–‡ä»¶"""
        result = {"passed": True, "issues": []}
        evidence_dir = Path(outputs_dir) / "stage1" / "evidence" / "evidence"

        if not evidence_dir.exists():
            result["issues"].append("è¯æ®ç›®å½•ä¸å­˜åœ¨")
            result["passed"] = False
            return result

        # æ£€æŸ¥æ‰€æœ‰è¯æ®æ–‡ä»¶
        evidence_files = list(evidence_dir.glob("*.txt"))
        for evidence_file in evidence_files:
            content = evidence_file.read_text(encoding='utf-8')

            # æ£€æŸ¥è„±æ•æ ‡è®°
            anonymization_markers = ['æŸæŸ', 'æŸå…¬å¸', 'æŸæœ‰é™']
            for marker in anonymization_markers:
                if marker in content:
                    result["issues"].append(f"å‘ç°è„±æ•æ ‡è®°: {marker} in {evidence_file.name}")

            # æ£€æŸ¥Markdownè¡¨æ ¼
            if '|' in content and ':---' in content:
                result["issues"].append(f"å‘ç°Markdownè¡¨æ ¼: {evidence_file.name}")

        # æ£€æŸ¥è¯æ®æ•°é‡
        if len(evidence_files) < 5:
            result["issues"].append(f"è¯æ®æ•°é‡ä¸è¶³: {len(evidence_files)}ä¸ª")

        return result

    def validate_key_numbers(self, key_numbers: dict) -> bool:
        """éªŒè¯å…³é”®é‡‘é¢æ•°æ®ä¸€è‡´æ€§"""
        # è®¾å¤‡æ¸…å•æ€»é¢ vs åˆåŒé‡‘é¢
        equipment_total = sum(
            item.get('è¯„ä¼°ä»·å€¼', 0) if isinstance(item, dict) else 0
            for item in key_numbers.get('ç§Ÿèµç‰©æ¸…å•', [])
        )
        contract_amount = key_numbers.get('åˆåŒé‡‘é¢', 0)

        if equipment_total != contract_amount:
            self.warnings.append(
                f"è®¾å¤‡æ¸…å•æ€»é¢({equipment_total}) != åˆåŒé‡‘é¢({contract_amount})"
            )
            return False

        return True
```

#### 3.4.1 éªŒè¯æ£€æŸ¥é¡¹

| æ£€æŸ¥é¡¹ | è¯´æ˜ | ä¸¥é‡ç¨‹åº¦ |
|--------|------|---------|
| è„±æ•æ ‡è®°æ£€æŸ¥ | æ£€æŸ¥"æŸæŸ"ã€"æŸå…¬å¸"ç­‰è„±æ•æ ‡è®° | ğŸ”´ é«˜ |
| Markdownè¡¨æ ¼æ£€æŸ¥ | æ£€æŸ¥è¡¨æ ¼æ ¼å¼æ˜¯å¦ä¸ºMarkdown | ğŸŸ¡ ä¸­ |
| æ¢è¡Œæ ¼å¼æ£€æŸ¥ | æ£€æŸ¥åˆåŒæ¡æ¬¾æ˜¯å¦æ­£ç¡®æ¢è¡Œ | ğŸŸ¡ ä¸­ |
| æ¡æ¬¾å¼•ç”¨æ ¼å¼æ£€æŸ¥ | æ£€æŸ¥"ç¬¬ä¸€æ¡ ç¬¬1.2æ¬¾"æ˜¯å¦è¢«æ–­å¼€ | ğŸŸ¡ ä¸­ |
| æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥ | æ£€æŸ¥è®¾å¤‡æ€»é¢=åˆåŒé‡‘é¢ | ğŸ”´ é«˜ |
| è¯æ®å®Œæ•´æ€§æ£€æŸ¥ | æ£€æŸ¥è¯æ®æ•°é‡å’Œå†…å®¹ | ğŸŸ¡ ä¸­ |

#### 3.4.2 éªŒè¯æµç¨‹

```
QualityValidator.validate_all()
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                        â”‚
         â–¼                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éªŒè¯Stage0æ•°æ®   â”‚                    â”‚ éªŒè¯è¯æ®æ–‡ä»¶     â”‚
â”‚                  â”‚                    â”‚                  â”‚
â”‚ è¯»å–0.4_         â”‚                    â”‚ éå†æ‰€æœ‰         â”‚
â”‚ key_numbers.json â”‚                    â”‚ evidence/*.txt   â”‚
â”‚                  â”‚                    â”‚                  â”‚
â”‚ æ£€æŸ¥:            â”‚                    â”‚ æ£€æŸ¥:            â”‚
â”‚ - è®¾å¤‡æ¸…å•       â”‚                    â”‚ - è„±æ•æ ‡è®°       â”‚
â”‚ - æŠµæŠ¼ç‰©æ¸…å•     â”‚                    â”‚ - Markdownè¡¨æ ¼   â”‚
â”‚ - ç§Ÿé‡‘è®¡åˆ’       â”‚                    â”‚ - è¯æ®æ•°é‡       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ æ±‡æ€»éªŒè¯ç»“æœ     â”‚
                  â”‚                  â”‚
                  â”‚ results = {      â”‚
                  â”‚   "passed": bool, â”‚
                  â”‚   "issues": [],  â”‚
                  â”‚   "warnings": [] â”‚
                  â”‚ }                â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é˜¶æ®µ6: PDFæ¸²æŸ“ (1-2å¤©)

| ä»»åŠ¡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© | çŠ¶æ€ |
|------|--------|--------|------|
| å®ç°ContractRenderer | å¼€å‘ | contract_renderer.py | å¾…å¼€å§‹ |
| å®ç°TableRenderer | å¼€å‘ | table_renderer.py | å¾…å¼€å§‹ |
| å®ç°SmartPaginator | å¼€å‘ | smart_paginator.py | å¾…å¼€å§‹ |
| é›†æˆæµ‹è¯• | å¼€å‘ | æµ‹è¯•æŠ¥å‘Š | å¾…å¼€å§‹ |

### é˜¶æ®µ7: ç«¯åˆ°ç«¯é›†æˆ (1å¤©)

| ä»»åŠ¡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© | çŠ¶æ€ |
|------|--------|--------|------|
| å®ç°run_complete.pyç»Ÿä¸€å…¥å£ | å¼€å‘ | run_complete.py | âœ… å®Œæˆ |
| å®ç°è‡ªåŠ¨éªŒè¯ç³»ç»ŸQualityValidator | å¼€å‘ | validator.py | âœ… å®Œæˆ |
| å®Œæ•´æµç¨‹æµ‹è¯• | å¼€å‘ | æµ‹è¯•æŠ¥å‘Š | âœ… å®Œæˆ |
| ä¿®å¤Bug | å¼€å‘ | Bugä¿®å¤è®°å½• | âœ… å®Œæˆ |

---

## å…­ã€éªŒæ”¶æ ‡å‡†ï¼ˆv1.1æ›´æ–°ï¼‰

- [x] CacheManageræ”¯æŒæŒ‰åˆ¤å†³ä¹¦å“ˆå¸Œç¼“å­˜
- [x] CacheManageræ”¯æŒç¼“å­˜æ¸…ç†ç­–ç•¥ï¼ˆ30å¤©è¿‡æœŸã€100ä¸ªä¸Šé™ï¼‰
- [x] BoundaryConditionExtractoræ”¯æŒLLMå’Œæ­£åˆ™ä¸¤ç§æå–æ–¹å¼
- [x] TestConfigInjectoræ”¯æŒé”™è¯¯æ³¨å…¥
- [x] TemplateLibraryæä¾›å®Œæ•´çš„æ¨¡æ¿æ•°æ®
- [x] DataCalculatoræ­£ç¡®è®¡ç®—ç§Ÿé‡‘è®¡åˆ’
- [x] DynamicPromptBuilderæ­£ç¡®æ³¨å…¥ä¸Šä¸‹æ–‡
- [x] EvidenceRendererå®ç°åˆåŒå’Œè¡¨æ ¼ä¸¤ç§æ ¼å¼
- [x] åŒä¸€åˆ¤å†³ä¹¦ä¸¤æ¬¡è¿è¡Œè¿”å›ç›¸åŒæ•°æ®
- [x] ä¸åŒåˆ¤å†³ä¹¦ç”Ÿæˆä¸åŒæ•°æ®
- [x] æµ‹è¯•é…ç½®èƒ½æ­£ç¡®æ³¨å…¥é”™è¯¯
- [x] æ‰€æœ‰ç»„ä»¶é€šè¿‡å•å…ƒæµ‹è¯•
- [x] å®Œæ•´æµç¨‹æµ‹è¯•é€šè¿‡
- [x] **æ–°å¢**: run_complete.py ç»Ÿä¸€å…¥å£æ­£å¸¸å·¥ä½œ
- [x] **æ–°å¢**: QualityValidator éªŒè¯ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
- [x] **æ–°å¢**: è¯æ®æ–‡ä»¶æ— è„±æ•æ ‡è®°
- [x] **æ–°å¢**: åˆåŒæ¡æ¬¾æ­£ç¡®æ¢è¡Œæ ¼å¼

### 3.2 TemplateLibrary

```python
class TemplateLibrary:
    """æ¨¡æ¿åº“ - æä¾›è‡ªåŠ¨ç”Ÿæˆæ‰€éœ€çš„æ¨¡æ¿æ•°æ®"""
    
    def __init__(self, template_dir: str = "config/template_libraries"):
        self.template_dir = Path(template_dir)
        self._load_templates()
    
    def _load_templates(self):
        """åŠ è½½æ‰€æœ‰æ¨¡æ¿æ•°æ®"""
        # å…¬å¸åç§°æ¨¡æ¿
        company_names_path = self.template_dir / "company_names.json"
        if company_names_path.exists():
            with open(company_names_path, 'r', encoding='utf-8') as f:
                self.company_names = json.load(f)
        else:
            self.company_names = []
        
        # è®¾å¤‡åç§°æ¨¡æ¿
        equipment_names_path = self.template_dir / "equipment_names.json"
        if equipment_names_path.exists():
            with open(equipment_names_path, 'r', encoding='utf-8') as f:
                self.equipment_names = json.load(f)
        else:
            self.equipment_names = []
        
        # åœ°å€æ¨¡æ¿
        locations_path = self.template_dir / "locations.json"
        if locations_path.exists():
            with open(locations_path, 'r', encoding='utf-8') as f:
                self.locations = json.load(f)
        else:
            self.locations = []
    
    def generate_equipment_list(self, count: int, total_value: int) -> List[dict]:
        """
        ç”Ÿæˆè®¾å¤‡æ¸…å•
        Args:
            count: è®¾å¤‡æ•°é‡
            total_value: æ€»è¯„ä¼°ä»·å€¼
        Returns:
            è®¾å¤‡åˆ—è¡¨
        """
        equipment_list = []
        remaining_value = total_value
        
        for i in range(count):
            # æœ€åä¸€ä¸ªè®¾å¤‡ä½¿ç”¨å‰©ä½™ä»·å€¼
            if i == count - 1:
                value = remaining_value
            else:
                # éšæœºåˆ†é…ä»·å€¼ï¼ˆä¿ç•™10%ç»™æœ€åä¸€ä¸ªï¼‰
                max_value = int(remaining_value * 0.15)
                value = random.randint(int(max_value * 0.5), max_value)
                remaining_value -= value
            
            # ä»æ¨¡æ¿åº“é€‰æ‹©è®¾å¤‡åç§°
            equipment_name = random.choice(self.equipment_names)
            
            equipment = {
                "åºå·": i + 1,
                "è®¾å¤‡åç§°": equipment_name["åç§°"],
                "è§„æ ¼å‹å·": equipment_name.get("è§„æ ¼å‹å·", f"Model-{random.randint(100,999)}"),
                "æ•°é‡": f"{random.randint(1, 10)}å¥—",
                "å­˜æ”¾åœ°ç‚¹": random.choice(self.locations)["åœ°å€"],
                "è¯„ä¼°ä»·å€¼": value
            }
            equipment_list.append(equipment)
        
        return equipment_list
    
    def generate_bank_account(self) -> str:
        """ç”Ÿæˆéšæœºé“¶è¡Œè´¦å·"""
        return f"1502211009{random.randint(10000000, 99999999)}"
```

### 3.3 DataCalculator

```python
class DataCalculator:
    """æ•°æ®è®¡ç®—å™¨ - æ ¹æ®è¾¹ç•Œæ¡ä»¶è®¡ç®—è¯¦ç»†æ•°æ®"""
    
    def calculate_rent_schedule(
        self,
        principal: float,
        annual_rate: float,
        periods: int,
        start_date: str
    ) -> List[dict]:
        """
        è®¡ç®—ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’
        Args:
            principal: æœ¬é‡‘ï¼ˆèèµ„é‡‘é¢ï¼‰
            annual_rate: å¹´åˆ©ç‡
            periods: æœŸæ•°
            start_date: å¼€å§‹æ—¥æœŸ (YYYY-MM-DD)
        Returns:
            ç§Ÿé‡‘æ”¯ä»˜è®¡åˆ’åˆ—è¡¨
        """
        # æœˆåˆ©ç‡
        monthly_rate = annual_rate / 12
        
        # ç­‰é¢æœ¬æ¯è®¡ç®—
        if monthly_rate > 0:
            monthly_payment = principal * (monthly_rate * (1 + monthly_rate) ** periods) / (
                (1 + monthly_rate) ** periods - 1
            )
        else:
            monthly_payment = principal / periods
        
        schedule = []
        start = datetime.strptime(start_date, "%Y-%m-%d")
        
        for i in range(1, periods + 1):
            # è®¡ç®—æœ¬é‡‘å’Œåˆ©æ¯
            interest = principal * monthly_rate
            principal_payment = monthly_payment - interest
            
            schedule.append({
                "æœŸæ•°": i,
                "åº”ä»˜æ—¥æœŸ": self._add_months(start, i).strftime("%Y-%m-%d"),
                "ç§Ÿé‡‘é‡‘é¢": round(monthly_payment, 2),
                "æœ¬é‡‘é‡‘é¢": round(principal_payment, 2),
                "åˆ©æ¯é‡‘é¢": round(interest, 2),
                "æ”¯ä»˜çŠ¶æ€": "å·²ä»˜" if i <= 2 else "æœªä»˜"  # å‡è®¾å‰2æœŸå·²ä»˜
            })
            
            principal -= principal_payment
        
        return schedule
    
    def _add_months(self, start_date: datetime, months: int) -> datetime:
        """æ·»åŠ æœˆä»½"""
        new_year = start_date.year + (start_date.month + months - 1) // 12
        new_month = (start_date.month + months - 1) % 12 + 1
        return start_date.replace(year=new_year, month=new_month)
```

### 3.4 DynamicPromptBuilder

```python
class DynamicPromptBuilder:
    """åŠ¨æ€Promptæ„å»ºå™¨ - æ³¨å…¥ä¸Šä¸‹æ–‡å¹¶æ¸²æŸ“æ¨¡æ¿"""
    
    def __init__(self, template_dir: str = "config/evidence_templates"):
        self.template_dir = Path(template_dir)
        self.context_injector = ContextInjector()
        self.template_renderer = TemplateRenderer()
    
    def build_prompt(
        self,
        task_type: str,
        boundary_conditions: dict,
        deanonymization_context: dict,
        template_name: str
    ) -> str:
        """
        æ„å»ºå®Œæ•´çš„Prompt
        Args:
            task_type: ä»»åŠ¡ç±»å‹ (e.g., "ç”Ÿæˆèèµ„ç§ŸèµåˆåŒ")
            boundary_conditions: è¾¹ç•Œæ¡ä»¶
            deanonymization_context: åè„±æ•ä¸Šä¸‹æ–‡
            template_name: æ¨¡æ¿æ–‡ä»¶å
        Returns:
            å®Œæ•´çš„Promptå­—ç¬¦ä¸²
        """
        # åŠ è½½æ¨¡æ¿
        template_path = self.template_dir / template_name
        with open(template_path, 'r', encoding='utf-8') as f:
            template = f.read()
        
        # æ³¨å…¥ä¸Šä¸‹æ–‡
        context = self.context_injector.inject(
            boundary_conditions=boundary_conditions,
            deanonymization_context=deanonymization_context
        )
        
        # æ¸²æŸ“æ¨¡æ¿
        prompt = self.template_renderer.render(
            template=template,
            task_type=task_type,
            context=context
        )
        
        return prompt


class ContextInjector:
    """ä¸Šä¸‹æ–‡æ³¨å…¥å™¨"""
    
    def inject(
        self,
        boundary_conditions: dict,
        deanonymization_context: dict
    ) -> dict:
        """
        æ³¨å…¥æ‰€æœ‰ä¸Šä¸‹æ–‡
        Returns:
            åˆå¹¶åçš„ä¸Šä¸‹æ–‡å­—å…¸
        """
        # å±•å¼€å½“äº‹äººä¿¡æ¯
        parties = {}
        if "å½“äº‹äºº" in boundary_conditions:
            for role, marker in boundary_conditions["å½“äº‹äºº"].items():
                if marker in deanonymization_context.get("å…¬å¸Profileåº“", {}):
                    parties[role] = deanonymization_context["å…¬å¸Profileåº“"][marker]
        
        return {
            "boundary_conditions": boundary_conditions,
            "deanonymization_context": deanonymization_context,
            "parties": parties
        }


class TemplateRenderer:
    """æ¨¡æ¿æ¸²æŸ“å™¨"""
    
    def render(
        self,
        template: str,
        task_type: str,
        context: dict
    ) -> str:
        """
        æ¸²æŸ“æ¨¡æ¿
        Args:
            template: æ¨¡æ¿å­—ç¬¦ä¸²
            task_type: ä»»åŠ¡ç±»å‹
            context: ä¸Šä¸‹æ–‡å­—å…¸
        Returns:
            æ¸²æŸ“åçš„Prompt
        """
        # ä½¿ç”¨Pythonçš„å­—ç¬¦ä¸²æ ¼å¼åŒ–
        rendered = template.format(
            task_type=task_type,
            **self._flatten_context(context)
        )
        return rendered
    
    def _flatten_context(self, context: dict) -> dict:
        """å°†åµŒå¥—å­—å…¸å±•å¹³ä¸ºå•å±‚"""
        flat = {}
        
        def flatten(obj, prefix=""):
            if isinstance(obj, dict):
                for key, value in obj.items():
                    new_key = f"{prefix}_{key}" if prefix else key
                    flatten(value, new_key)
            else:
                flat[prefix] = obj
        
        flatten(context)
        return flat
```

### 3.5 EvidenceRenderer

```python
class EvidenceRenderer:
    """è¯æ®æ¸²æŸ“å™¨ - æ¸²æŸ“åˆåŒå’Œè¡¨æ ¼æ ¼å¼"""
    
    def __init__(self):
        self.contract_renderer = ContractRenderer()
        self.table_renderer = TableRenderer()
    
    def render_contract(
        self,
        title: str,
        contract_no: str,
        parties: List[dict],
        content: str,
        signatures: List[dict]
    ) -> List[PDFElement]:
        """
        æ¸²æŸ“åˆåŒæ ¼å¼
        Args:
            title: åˆåŒæ ‡é¢˜
            contract_no: åˆåŒç¼–å·
            parties: å½“äº‹äººåˆ—è¡¨
            content: åˆåŒæ­£æ–‡
            signatures: ç­¾ç½²ä¿¡æ¯
        Returns:
            PDFå…ƒç´ åˆ—è¡¨
        """
        elements = []
        
        # æ ‡é¢˜
        elements.append(Paragraph(
            title,
            ParagraphStyle(
                'ContractTitle',
                fontSize=18,
                fontName='SimHei',
                alignment=TA_CENTER,
                spaceAfter=20
            )
        ))
        
        # åˆåŒç¼–å·
        elements.append(Paragraph(
            f"åˆåŒç¼–å·ï¼š{contract_no}",
            ParagraphStyle(
                'ContractNo',
                fontSize=12,
                fontName='SimSun',
                alignment=TA_LEFT,
                spaceAfter=15
            )
        ))
        
        # å½“äº‹äººä¿¡æ¯
        for party in parties:
            party_text = f"ã€{party['role']}ã€‘\n"
            party_text += f"å…¬å¸åç§°ï¼š{party['name']}\n"
            party_text += f"ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼š{party['credit_code']}\n"
            party_text += f"æ³•å®šä»£è¡¨äººï¼š{party['representative']}\n"
            party_text += f"åœ°å€ï¼š{party['address']}\n"
            
            elements.append(Paragraph(
                party_text,
                ParagraphStyle(
                    'PartyInfo',
                    fontSize=12,
                    fontName='SimSun',
                    alignment=TA_LEFT,
                    spaceAfter=10
                )
            ))
        
        # åˆåŒæ­£æ–‡
        paragraphs = content.split('\n')
        for para in paragraphs:
            if para.strip():
                elements.append(Paragraph(
                    para,
                    ParagraphStyle(
                        'ContractContent',
                        fontSize=12,
                        fontName='SimSun',
                        alignment=TA_JUSTIFY,
                        spaceAfter=8
                    )
                ))
        
        # ç­¾ç½²æ 
        sig_text = "\n\n"
        for sig in signatures:
            sig_text += f"{sig['party']}ï¼ˆç›–ç« ï¼‰ï¼š{sig['name']}\n"
            sig_text += f"æ—¥æœŸï¼š{sig['date']}\n\n"
        
        elements.append(Paragraph(
            sig_text,
            ParagraphStyle(
                'Signature',
                fontSize=12,
                fontName='SimSun',
                alignment=TA_LEFT
            )
        ))
        
        return elements
    
    def render_table(
        self,
        title: str,
        headers: List[str],
        rows: List[List[str]]
    ) -> List[PDFElement]:
        """
        æ¸²æŸ“è¡¨æ ¼æ ¼å¼
        Args:
            title: è¡¨æ ¼æ ‡é¢˜
            headers: è¡¨å¤´
            rows: æ•°æ®è¡Œ
        Returns:
            PDFå…ƒç´ åˆ—è¡¨
        """
        elements = []
        
        # æ ‡é¢˜
        elements.append(Paragraph(
            title,
            ParagraphStyle(
                'TableTitle',
                fontSize=14,
                fontName='SimHei',
                alignment=TA_LEFT,
                spaceAfter=10
            )
        ))
        
        # åˆ›å»ºè¡¨æ ¼
        table_data = [headers] + rows
        table = Table(table_data)
        
        # è¡¨æ ¼æ ·å¼
        table.setStyle(TableStyle([
            # è¡¨å¤´æ ·å¼
            ('BACKGROUND', (0, 0), (-1, 0), colors.lightgrey),
            ('TEXTCOLOR', (0, 0), (-1, 0), colors.black),
            ('FONTNAME', (0, 0), (-1, 0), 'SimHei'),
            ('FONTSIZE', (0, 0), (-1, 0), 10),
            ('ALIGN', (0, 0), (-1, -1), 'CENTER'),
            # æ–‘é©¬çº¹
            ('ROWBACKGROUNDS', (0, 1), (-1, -1), [colors.white, colors.whitesmoke]),
            # è¾¹æ¡†
            ('GRID', (0, 0), (-1, -1), 0.5, colors.black),
            # å•å…ƒæ ¼å†…è¾¹è·
            ('TOPPADDING', (0, 0), (-1, -1), 6),
            ('BOTTOMPADDING', (0, 0), (-1, -1), 6),
            ('LEFTPADDING', (0, 0), (-1, -1), 8),
            ('RIGHTPADDING', (0, 0), (-1, -1), 8),
        ]))
        
        elements.append(table)
        
        return elements
```

### 3.6 SmartPaginator

```python
class SmartPaginator:
    """æ™ºèƒ½åˆ†é¡µæ§åˆ¶å™¨"""
    
    def __init__(self, output_path: str):
        self.output_path = output_path
        self.current_page = 0
        self.elements = []
    
    def add_evidence(self, evidence_id: str, elements: List[PDFElement]):
        """
        æ·»åŠ è¯æ®ï¼ˆè‡ªåŠ¨åˆ†é¡µï¼‰
        Args:
            evidence_id: è¯æ®ID
            elements: PDFå…ƒç´ åˆ—è¡¨
        """
        # å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªè¯æ®ï¼Œå¦èµ·æ–°é¡µ
        if self.elements:
            self.elements.append(PageBreak())
        
        self.elements.extend(elements)
    
    def build_pdf(self, doc_elements: List[PDFElement]):
        """
        æ„å»ºPDF
        Args:
            doc_elements: æ–‡æ¡£å…ƒç´ åˆ—è¡¨
        """
        from reportlab.lib.pagesizes import A4
        from reportlab.lib.units import cm
        from reportlab.platypus import SimpleDocTemplate
        
        doc = SimpleDocTemplate(
            self.output_path,
            pagesize=A4,
            rightMargin=2.5*cm,
            leftMargin=2.5*cm,
            topMargin=2.5*cm,
            bottomMargin=2.5*cm
        )
        
        doc.build(doc_elements)
```

---

## å››ã€æ¥å£è®¾è®¡

### 4.1 å…¥å£æ¥å£

```python
def generate_docket(
    judgment_path: str,
    output_path: str = "outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf",
    force_refresh: bool = False,
    test_config: Optional[dict] = None
) -> dict:
    """
    ç”Ÿæˆå®Œæ•´å·å®—PDF
    
    Args:
        judgment_path: åˆ¤å†³ä¹¦æ–‡ä»¶è·¯å¾„
        output_path: è¾“å‡ºPDFè·¯å¾„
        force_refresh: æ˜¯å¦å¼ºåˆ¶åˆ·æ–°ç¼“å­˜
        test_config: æµ‹è¯•é…ç½®ï¼ˆç”¨äºç”Ÿæˆé”™è¯¯æ•°æ®ï¼‰
    
    Returns:
        ç”Ÿæˆç»“æœ
        {
            "success": True,
            "pdf_path": "outputs/å®Œæ•´æµ‹è¯•å·å®—_ç®€åŒ–ç‰ˆ.pdf",
            "evidence_count": 10,
            "cache_key": "abc123...",
            "data_sources": {
                "boundary_conditions": "åˆ¤å†³ä¹¦",
                "equipment_list": "æ¨¡æ¿ç”Ÿæˆ",
                "rent_schedule": "è®¡ç®—ç”Ÿæˆ"
            }
        }
    """
    pass
```

### 4.2 DataGeneratoræ¥å£

```python
class DataGenerator:
    """æ•°æ®ç”Ÿæˆå™¨"""
    
    def __init__(
        self,
        cache_dir: str = "cache",
        template_dir: str = "config/template_libraries"
    ):
        self.cache_manager = CacheManager(cache_dir)
        self.template_library = TemplateLibrary(template_dir)
        self.data_calculator = DataCalculator()
    
    def generate(
        self,
        judgment_path: str,
        boundary_conditions: dict,
        force_refresh: bool = False,
        test_config: Optional[dict] = None
    ) -> dict:
        """
        ç”Ÿæˆå®Œæ•´æ•°æ®
        
        Args:
            judgment_path: åˆ¤å†³ä¹¦è·¯å¾„
            boundary_conditions: è¾¹ç•Œæ¡ä»¶
            force_refresh: æ˜¯å¦å¼ºåˆ¶åˆ·æ–°
            test_config: æµ‹è¯•é…ç½®
        
        Returns:
            å®Œæ•´æ•°æ®
            {
                "judgment_hash": "abc123...",
                "boundary_conditions": {...},
                "generated_data": {...},
                "deanonymization_context": {...}
            }
        """
        pass
```

### 4.3 EvidenceRendereræ¥å£

```python
class EvidenceRenderer:
    """è¯æ®æ¸²æŸ“å™¨"""
    
    def render_contract(
        self,
        title: str,
        contract_no: str,
        parties: List[dict],
        content: str,
        signatures: List[dict]
    ) -> List[PDFElement]:
        """æ¸²æŸ“åˆåŒ"""
        pass
    
    def render_table(
        self,
        title: str,
        headers: List[str],
        rows: List[List[str]]
    ) -> List[PDFElement]:
        """æ¸²æŸ“è¡¨æ ¼"""
        pass
```

---

## äº”ã€å®ç°æ­¥éª¤

### é˜¶æ®µ1: åŸºç¡€è®¾æ–½ (1-2å¤©)

| ä»»åŠ¡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© |
|------|--------|--------|
| å®ç°CacheManager | å¼€å‘ | cache_manager.py |
| å®ç°TemplateLibrary | å¼€å‘ | template_library.py |
| åˆå§‹åŒ–æ¨¡æ¿æ•°æ® | å¼€å‘ | company_names.json, equipment_names.json, locations.json |
| å®ç°SHA256å“ˆå¸Œè®¡ç®— | å¼€å‘ | å•å…ƒæµ‹è¯• |

### é˜¶æ®µ2: æ•°æ®ç”Ÿæˆ (2-3å¤©)

| ä»»åŠ¡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© |
|------|--------|--------|
| å®ç°DataCalculator | å¼€å‘ | data_calculator.py |
| å®ç°ç§Ÿé‡‘è®¡ç®— | å¼€å‘ | å•å…ƒæµ‹è¯• |
| å®ç°è®¾å¤‡æ¸…å•ç”Ÿæˆ | å¼€å‘ | å•å…ƒæµ‹è¯• |
| å®ç°é“¶è¡Œè´¦å·ç”Ÿæˆ | å¼€å‘ | å•å…ƒæµ‹è¯• |

### é˜¶æ®µ3: Promptæ„å»º (1-2å¤©)

| ä»»åŠ¡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© |
|------|--------|--------|
| å®ç°ContextInjector | å¼€å‘ | context_injector.py |
| å®ç°TemplateRenderer | å¼€å‘ | template_renderer.py |
| å®ç°DynamicPromptBuilder | å¼€å‘ | dynamic_prompt_builder.py |
| åˆ›å»ºè¯æ®æ¨¡æ¿ | å¼€å‘ | contract_template.md, table_template.md |

### é˜¶æ®µ4: PDFæ¸²æŸ“ (1-2å¤©)

| ä»»åŠ¡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© |
|------|--------|--------|
| å®ç°ContractRenderer | å¼€å‘ | contract_renderer.py |
| å®ç°TableRenderer | å¼€å‘ | table_renderer.py |
| å®ç°SmartPaginator | å¼€å‘ | smart_paginator.py |
| é›†æˆæµ‹è¯• | å¼€å‘ | é›†æˆæµ‹è¯•æŠ¥å‘Š |

### é˜¶æ®µ5: ç«¯åˆ°ç«¯é›†æˆ (1å¤©)

| ä»»åŠ¡ | è´Ÿè´£äºº | äº¤ä»˜ç‰© |
|------|--------|--------|
| å®ç°generate_docketå…¥å£ | å¼€å‘ | run_full_regeneration.py |
| å®Œæ•´æµç¨‹æµ‹è¯• | å¼€å‘ | æµ‹è¯•æŠ¥å‘Š |
| ä¿®å¤Bug | å¼€å‘ | Bugä¿®å¤è®°å½• |

---

## å…­ã€æµ‹è¯•ç­–ç•¥

### 6.1 å•å…ƒæµ‹è¯•

| ç»„ä»¶ | æµ‹è¯•ç‚¹ | æµ‹è¯•ç”¨ä¾‹ |
|------|--------|---------|
| CacheManager | å“ˆå¸Œè®¡ç®— | åŒä¸€æ–‡ä»¶è¿”å›ç›¸åŒå“ˆå¸Œ |
| CacheManager | ç¼“å­˜è¯»å†™ | å†™å…¥åèƒ½æ­£ç¡®è¯»å– |
| TemplateLibrary | è®¾å¤‡ç”Ÿæˆ | ç”ŸæˆæŒ‡å®šæ•°é‡è®¾å¤‡ |
| TemplateLibrary | é“¶è¡Œè´¦å· | è´¦å·æ ¼å¼æ­£ç¡® |
| DataCalculator | ç§Ÿé‡‘è®¡ç®— | é‡‘é¢æ€»å’Œç­‰äºæœ¬é‡‘+åˆ©æ¯ |
| DynamicPromptBuilder | ä¸Šä¸‹æ–‡æ³¨å…¥ | å˜é‡æ›¿æ¢æ­£ç¡® |
| EvidenceRenderer | åˆåŒæ¸²æŸ“ | æ ¼å¼æ­£ç¡® |
| EvidenceRenderer | è¡¨æ ¼æ¸²æŸ“ | æ ·å¼æ­£ç¡® |

### 6.2 é›†æˆæµ‹è¯•

| æµ‹è¯•åœºæ™¯ | é¢„æœŸç»“æœ |
|---------|---------|
| åŒä¸€åˆ¤å†³ä¹¦è¿è¡Œ2æ¬¡ | ç¬¬äºŒæ¬¡ä½¿ç”¨ç¼“å­˜æ•°æ® |
| ä¸åŒåˆ¤å†³ä¹¦ | å„è‡ªç”Ÿæˆç‹¬ç«‹æ•°æ® |
| å¼ºåˆ¶åˆ·æ–° | é‡æ–°ç”Ÿæˆæ•°æ® |
| å®Œæ•´æµç¨‹ | PDFç”ŸæˆæˆåŠŸ |

### 6.3 æµ‹è¯•å‘½ä»¤ï¼ˆv1.1æ›´æ–°ï¼‰

```bash
# å•å…ƒæµ‹è¯•
python3 -m pytest tests/unit/ -v

# é›†æˆæµ‹è¯•
python3 -m pytest tests/integration/ -v

# å®Œæ•´æµç¨‹æµ‹è¯•ï¼ˆæ¨èä½¿ç”¨ç»Ÿä¸€å…¥å£ï¼‰
python3 run_complete.py

# ç‹¬ç«‹éªŒè¯ï¼ˆä¸é‡æ–°ç”Ÿæˆï¼‰
python3 run_complete.py --verify
python3 validate_outputs.py  # ç­‰æ•ˆ

# é˜¶æ®µæ§åˆ¶
python3 run_complete.py --stage0  # ä»…Stage0
python3 run_complete.py --stage1  # Stage0+Stage1
python3 run_complete.py --stage2  # Stage0+Stage1+PDF

# å¼ºåˆ¶åˆ·æ–°ç¼“å­˜
python3 run_complete.py --force

# åºŸå¼ƒè„šæœ¬ï¼ˆæ—§å…¥å£ï¼Œå·²æ·»åŠ åºŸå¼ƒè­¦å‘Šï¼‰
python3 run_full_regeneration.py --all  # âš ï¸ æ˜¾ç¤ºåºŸå¼ƒè­¦å‘Š
python3 generate_pdf.py                 # âš ï¸ æ˜¾ç¤ºåºŸå¼ƒè­¦å‘Š
```

---

**æ–‡æ¡£ç»“æŸ**

**åˆ›å»ºäºº**: OpenCode AI
**åˆ›å»ºæ—¥æœŸ**: 2026-01-27
**æœ€åæ›´æ–°**: 2026-01-28 (v1.2 - æ¶æ„è®¾è®¡æ›´æ–°ä»¥åæ˜ å®é™…å®ç°)
**çŠ¶æ€**: å·²è¯„å®¡ï¼ˆv1.2æ¶æ„æ›´æ–°ï¼Œéƒ¨åˆ†ç»„ä»¶ç»†èŠ‚å¾…åŒæ­¥ï¼‰
