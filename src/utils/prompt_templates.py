"""
LLM提示词模板模块
为每种证据类型设计专门的生成提示词
"""
from typing import Dict, Any, List


# 证据类型配置
EVIDENCE_TYPES = {
    "transfer_contract": {
        "name": "转让合同",
        "description": "设备所有权转让协议",
        "format": "合同格式",
        "required_fields": ["合同编号", "甲乙方信息", "转让标的", "价款支付", "权利义务", "违约责任", "争议解决"],
    },
    "finance_lease_contract": {
        "name": "融资租赁合同",
        "description": "售后回租融资租赁协议",
        "format": "合同格式",
        "required_fields": ["合同编号", "出租人", "承租人", "租赁物", "租赁期限", "租金", "保证金", "违约责任"],
    },
    "equipment_list": {
        "name": "租赁物清单",
        "description": "融资租赁设备清单",
        "format": "JSON数组格式",
        "required_fields": ["序号", "名称", "规格型号", "数量", "存放地点", "评估价值"],
    },
    "payment_receipt": {
        "name": "付款回单",
        "description": "银行付款凭证",
        "format": "银行凭证格式",
        "required_fields": ["付款人", "收款人", "金额", "日期", "流水号", "用途"],
    },
    "execution_certificate": {
        "name": "执行证书",
        "description": "公证处出具的执行文书",
        "format": "公证文书格式",
        "required_fields": ["证书编号", "公证处", "申请执行人", "被执行人", "执行依据", "执行标的"],
    },
    "assessment_report": {
        "name": "资产评估报告",
        "description": "设备价值评估报告",
        "format": "评估报告格式",
        "required_fields": ["报告编号", "评估机构", "评估对象", "评估方法", "评估结论", "设备清单"],
    },
    "mortgage_certificate": {
        "name": "抵押登记证书",
        "description": "不动产抵押登记证明",
        "format": "权属证书格式",
        "required_fields": ["证书编号", "权利人", "义务人", "坐落", "面积", "抵押信息"],
    },
    "rent_record": {
        "name": "租金支付记录",
        "description": "租金支付明细表",
        "format": "财务表格格式",
        "required_fields": ["合同编号", "承租人", "期数", "应付金额", "实付金额", "状态"],
    },
    "interest_calculation": {
        "name": "逾期利息计算表",
        "description": "逾期利息计算明细",
        "format": "计算表格格式",
        "required_fields": ["计算公式", "本金", "逾期天数", "利率", "利息金额"],
    },
    "attorney_contract": {
        "name": "委托代理合同",
        "description": "律师服务委托协议",
        "format": "合同格式",
        "required_fields": ["合同编号", "委托方", "受托方", "委托事项", "代理权限", "律师费"],
    },
    "insurance_policy": {
        "name": "保全保险单",
        "description": "诉讼财产保全责任保险",
        "format": "保险单据格式",
        "required_fields": ["保单号", "保险人", "投保人", "保险标的", "保险金额", "保费"],
    },
    "consulting_contract": {
        "name": "咨询服务合同",
        "description": "融资咨询服务协议",
        "format": "合同格式",
        "required_fields": ["合同编号", "委托方", "服务方", "服务内容", "服务费"],
    },
    "shareholder_decision": {
        "name": "股东决定",
        "description": "公司对外担保股东会决议",
        "format": "公司决议格式",
        "required_fields": ["公司信息", "会议信息", "决议内容", "股东签字"],
    },
    "guarantee_contract": {
        "name": "保证合同",
        "description": "连带责任保证担保协议",
        "format": "合同格式",
        "required_fields": ["合同编号", "保证人", "债权人", "被担保债权", "保证方式", "保证期间"],
    },
    "deposit_proof": {
        "name": "保证金收据",
        "description": "保证金支付凭证",
        "format": "收据格式",
        "required_fields": ["收据编号", "付款单位", "收款单位", "金额", "事由"],
    },
}


def build_prompt(evidence_type: str, case_data: Dict[str, Any]) -> str:
    """
    为指定证据类型构建LLM生成提示词
    
    Args:
        evidence_type: 证据类型标识
        case_data: 案件数据字典
    
    Returns:
        完整的提示词字符串
    """
    if evidence_type not in EVIDENCE_TYPES:
        raise ValueError(f"Unknown evidence type: {evidence_type}")
    
    config = EVIDENCE_TYPES[evidence_type]
    
    # 根据证据类型选择不同的提示词模板
    prompts = {
        "transfer_contract": _prompt_transfer_contract,
        "finance_lease_contract": _prompt_finance_lease_contract,
        "equipment_list": _prompt_equipment_list,
        "payment_receipt": _prompt_payment_receipt,
        "execution_certificate": _prompt_execution_certificate,
        "assessment_report": _prompt_assessment_report,
        "mortgage_certificate": _prompt_mortgage_certificate,
        "rent_record": _prompt_rent_record,
        "interest_calculation": _prompt_interest_calculation,
        "attorney_contract": _prompt_attorney_contract,
        "insurance_policy": _prompt_insurance_policy,
        "consulting_contract": _prompt_consulting_contract,
        "shareholder_decision": _prompt_shareholder_decision,
        "guarantee_contract": _prompt_guarantee_contract,
        "deposit_proof": _prompt_deposit_proof,
    }
    
    return prompts[evidence_type](case_data)


def _format_case_data(case_data: Dict[str, Any]) -> str:
    """格式化案件数据为提示词的一部分"""
    lines = ["【案件数据】"]
    for key, value in case_data.items():
        if isinstance(value, (int, float)):
            formatted = f"{value:,.2f}" if isinstance(value, float) else f"{value:,}"
        else:
            formatted = str(value)
        lines.append(f"- {key}: {formatted}")
    return "\n".join(lines)


# ============== 各证据类型提示词 ==============

def _prompt_equipment_list(case_data: Dict[str, Any]) -> str:
    """生成租赁物清单的提示词"""
    total_value = case_data.get('合同金额', 150000000)
    return f"""你是一位资产评估师。请根据以下案件信息，编造一份融资租赁用的《设备清单》。

【任务说明】
这是一份融资租赁设备的详细清单，用于评估和抵押。设备类型应符合商场运营需要，数量和价值应与合同金额匹配。

【格式要求】
请直接输出JSON数组格式，不要有其他说明。JSON格式如下：
[
  {{
    "序号": 1,
    "名称": "设备名称",
    "规格型号": "型号",
    "数量": "数量",
    "存放地点": "详细地址",
    "评估价值": 金额
  }},
  ...
]

【案件数据】
- 承租人: {case_data['被告']}
- 承租人地址: {case_data['被告地址']}
- 合同金额: 人民币{total_value:,}元
- 租赁物总价值应等于合同金额

【设备类型参考】
商场常用设备包括：
- 中央空调系统（冷水机组、多联机等）
- 电梯设备（客梯、货梯、自动扶梯）
- 配电设备（变压器、开关柜）
- 消防设备（消防泵、消防报警系统）
- 监控系统（安防摄像头、录像机）
- 照明设备
- 其他附属设施

【要求】
1. 生成5-10项设备
2. 每项设备的评估价值应该是整数，便于计算
3. 所有设备价值相加必须等于合同金额 {total_value:,} 元
4. 存放地点统一使用承租人地址
5. 设备名称和规格型号应专业、真实可信

请直接输出JSON数组，不要有其他说明。"""


def _prompt_transfer_contract(case_data: Dict[str, Any]) -> str:
    return f"""你是一位专业的法律文书撰写人。请根据以下案件信息，撰写一份《设备转让合同》。

【任务说明】
这是一份融资租赁售后回租模式下的设备转让合同。合同应包含完整的法律要素，格式规范，内容真实可信。

【格式要求】
1. 使用【】标注各个章节标题
2. 包含：合同编号、甲乙方信息、鉴于条款、转让标的、价款支付、权利义务、违约责任、争议解决、公证条款、签署栏
3. 合同总长度约800-1200字
4. 语言风格：正式法律文书风格

【案件数据】
- 合同编号: ZR-2021-001
- 转让方（甲方）: {case_data['被告']}
- 转让方信用代码: {case_data['被告信用代码']}
- 转让方法定代表人: {case_data['被告法人']}
- 转让方地址: {case_data['被告地址']}
- 受让方（乙方）: {case_data['原告']}
- 受让方信用代码: {case_data['原告信用代码']}
- 受让方法定代表人: {case_data['原告法人']}
- 受让方地址: {case_data['原告地址']}
- 转让价格: 人民币{case_data['合同金额']:,}元
- 签订日期: {case_data['签订日期']}
- 公证编号: {case_data.get('公证编号', '（2021）沪长证经字第XXXX号')}

【特别注意】
1. 鉴于条款应说明双方身份和融资租赁关系背景
2. 转让标的应具体描述设备类型和数量
3. 价款支付应明确支付方式和账户信息
4. 权利义务应平衡双方利益
5. 违约责任应具体可行
6. 公证条款应与公证编号对应

请直接输出合同内容，不要有其他说明。"""


def _prompt_finance_lease_contract(case_data: Dict[str, Any]) -> str:
    return f"""你是一位专业的法律文书撰写人。请根据以下案件信息，撰写一份《融资租赁合同（售后回租）》。

【任务说明】
这是一份售后回租模式的融资租赁合同。合同应明确租赁物、租金、期限、违约责任等核心条款。

【格式要求】
1. 使用【】标注各个章节标题
2. 包含：合同编号、出租人信息、承租人信息、鉴于条款、租赁物、租赁期限、租金及支付、保证金、违约责任、公证条款、签署栏
3. 合同总长度约1000-1500字
4. 语言风格：正式法律文书风格

【案件数据】
- 合同编号: RZL-2021-001
- 出租人: {case_data['原告']}
- 出租人信用代码: {case_data['原告信用代码']}
- 出租方法定代表人: {case_data['原告法人']}
- 出租人地址: {case_data['原告地址']}
- 承租人: {case_data['被告']}
- 承租人信用代码: {case_data['被告信用代码']}
- 承租方法定代表人: {case_data['被告法人']}
- 承租人地址: {case_data['被告地址']}
- 租赁物: 某某商场设备及附属设施
- 租赁物评估价值: 人民币{case_data['合同金额']:,}元
- 租赁期限: {case_data['租赁期限']}个月
- 起租日: {case_data['交付日期']}
- 租金年利率: {case_data['利率']*100:.2f}%
- 保证金: 人民币{case_data['保证金']:,}元
- 签订日期: {case_data['签订日期']}
- 公证编号: {case_data.get('公证编号', '（2021）沪长证经字第XXXX号')}

【特别注意】
1. 租金计算应合理，基于合同金额和利率
2. 违约责任应包含逾期利息条款（日万分之五）
3. 应明确租赁期满后的设备归属
4. 公证条款应与公证编号对应

请直接输出合同内容，不要有其他说明。"""


def _prompt_payment_receipt(case_data: Dict[str, Any]) -> str:
    return f"""你是一位银行柜员。请根据以下信息，填写一份银行付款回单。

【任务说明】
这是一份真实的银行付款凭证，应包含完整的银行交易信息。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：基本信息（付款人、收款人、银行信息）、交易信息（金额、日期、流水号、用途）
3. 长度约300-500字
4. 格式应像真实的银行回单

【案件数据】
- 付款人: {case_data['原告']}
- 付款人账号: 工商银行上海浦东分行 1234567890123456
- 收款人: {case_data['被告']}
- 收款人账号: 工商银行南昌县支行 9876543210987654
- 交易金额: 人民币{case_data['合同金额']:,}元
- 交易日期: {case_data['交付日期']}
- 交易流水号: BJ20210226012345
- 用途: 设备转让款（合同编号：ZR-2021-001）

【特别注意】
1. 金额应使用大写：人民币壹亿伍仟万元整
2. 流水号应有合理格式（日期+序号）
3. 应有附言说明用途
4. 应有凭证状态信息

请直接输出回单内容，不要有其他说明。"""


def _prompt_execution_certificate(case_data: Dict[str, Any]) -> str:
    return f"""你是一位公证员。请根据以下信息，出具一份《执行证书》。

【任务说明】
这是一份公证处出具的执行证书，用于申请强制执行。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：证书编号、公证处信息、申请执行人、被执行人、执行依据、执行标的、事实概要、执行内容、公证员、日期
3. 长度约600-800字
4. 格式应像真实的公证文书

【案件数据】
- 公证处: 上海市长宁公证处
- 证书编号: {case_data.get('执行证书编号', '（2021）沪长证执字第XXXX号')}
- 申请执行人: {case_data['原告']}
- 申请执行人地址: {case_data['原告地址']}
- 被执行人: {case_data['被告']}
- 被执行人地址: {case_data['被告地址']}
- 执行依据公证书编号: {case_data.get('公证编号', '（2021）沪长证经字第XXXX号')}
- 执行标的: 未付租金人民币{case_data['未付租金']:,.2f}元及逾期利息
- 公证员: 张某某

【特别注意】
1. 执行标的应准确对应案件数据
2. 事实概要应说明公证债权文书的来源
3. 应有明确的执行内容和法律依据
4. 应注明证书有效期

请直接输出执行证书内容，不要有其他说明。"""


def _prompt_assessment_report(case_data: Dict[str, Any]) -> str:
    return f"""你是一位资产评估师。请根据以下信息，撰写一份《资产评估报告》。

【任务说明】
这是一份融资租赁用的设备资产评估报告，应包含完整的评估信息。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：报告编号、委托方信息、评估对象、评估机构、评估方法、评估结论、设备清单、评估师、日期
3. 长度约800-1200字
4. 格式应像真实的评估报告

【案件数据】
- 报告编号: PG-2021-001
- 委托方: {case_data['被告']}
- 委托方地址: {case_data['被告地址']}
- 评估对象: 某某商场设备及附属设施
- 评估基准日: {case_data['签订日期']}
- 评估机构: 上海某某资产评估有限公司
- 评估方法: 成本法
- 评估价值: 人民币{case_data['合同金额']:,}元
- 评估师: 张某某、李某某

【设备清单示例】
- 多联机中央空调系统 VRV VIII代 10套 45,000,000元
- 冷水机组 离心式RF1-5000 2套 12,000,000元
- 电梯设备 曳引式客梯KONIA-1000 4台 8,000,000元
- 配电变压器 SCB13-2500/10 8台 6,400,000元
- 消防水泵 XBD15/40 10套 3,200,000元

【特别注意】
1. 设备清单应包含5-8项主要设备
2. 各项设备价格应加起来等于总评估价值
3. 评估师应有合理的资质编号
4. 应有附件说明

请直接输出评估报告内容，不要有其他说明。"""


def _prompt_mortgage_certificate(case_data: Dict[str, Any]) -> str:
    return f"""你是一位不动产登记工作人员。请根据以下信息，填写一份《不动产权证书》抵押信息页。

【任务说明】
这是一份不动产权证书的抵押信息登记页。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：证书编号、权利人信息、义务人信息、坐落、不动产单元号、权利类型、用途、面积、抵押信息、发证机关
3. 长度约500-700字
4. 格式应像真实的不动产权证书

【案件数据】
- 证书编号: {case_data.get('抵押登记编号', '赣（2021）南昌市不动产权第XXXXXXX号')}
- 权利人（抵押权人）: {case_data['原告']}
- 义务人（抵押人）: {case_data['被告二']}
- 坐落: 江西省南昌市西湖区抚生路369号
- 权利类型: 国有建设用地使用权/房屋所有权
- 用途: 商业用地/商业
- 建筑面积: 15,000.00平方米
- 土地使用权面积: 5,000.00平方米
- 抵押担保债权数额: 人民币{case_data['合同金额']:,}元
- 债务履行期限: {case_data['签订日期']}至2024年2月24日
- 发证机关: 南昌市自然资源局
- 发证日期: {case_data['签订日期']}

【特别注意】
1. 抵押信息应完整包含抵押权人、债权数额、期限
2. 应有登记证明编号
3. 发证机关应为实际存在的地方机关

请直接输出证书内容，不要有其他说明。"""


def _prompt_rent_record(case_data: Dict[str, Any]) -> str:
    return f"""你是一位财务人员。请根据以下信息，编制一份《租金支付记录》。

【任务说明】
这是一份融资租赁租金支付明细表，需要清晰展示每期租金的支付情况。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：合同信息、租金支付明细表（表格形式）、汇总信息、制作信息
3. 长度约400-600字
4. 格式应像真实的财务表格

【案件数据】
- 合同编号: RZL-2021-001
- 承租人: {case_data['被告']}
- 租赁期限: {case_data['交付日期']}至2024年2月24日
- 每期租金: 6,692,645.67元
- 已付期数: 2期
- 已付金额: 人民币{case_data['已付租金']:,.2f}元
- 未付金额: 人民币{case_data['未付租金']:,.2f}元
- 统计日期: 2024年2月24日

【表格格式示例】
期数 | 应付日期 | 应付金额 | 实付日期 | 实付金额 | 状态
---|---|---|---|---|---
1 | 2021-02-24 | 6,692,645.67 | 2021-02-24 | 6,692,645.67 | 已付
2 | 2021-03-24 | 6,692,645.67 | 2021-03-24 | 6,692,645.67 | 已付
3 | 2021-04-24 | 6,692,645.67 | - | - | 逾期
... | ... | ... | ... | ... | ...

【特别注意】
1. 表格应显示24期租金（{case_data['租赁期限']}个月）
2. 前2期应为已付状态
3. 第3期开始应为逾期状态
4. 汇总信息应与案件数据一致

请直接输出记录内容，不要有其他说明。"""


def _prompt_interest_calculation(case_data: Dict[str, Any]) -> str:
    return f"""你是一位财务人员。请根据以下信息，编制一份《逾期利息计算表》。

【任务说明】
这是一份融资租赁逾期利息的详细计算表。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：基本信息、计算公式、计算明细（表格形式）、汇总信息、计算说明、制作信息
3. 长度约500-700字
4. 格式应像真实的财务计算表

【案件数据】
- 合同编号: RZL-2021-001
- 承租人: {case_data['被告']}
- 逾期本金: 人民币{case_data['未付租金']:,.2f}元
- 逾期利息: 人民币{case_data['逾期利息']:,.2f}元
- 年利率: {case_data['利率']*100:.2f}%
- 日利率: {(case_data['利率']*100)/360:.4f}%
- 保证金: 人民币{case_data['保证金']:,}元
- 计算日期: 2024年2月24日

【计算公式】
逾期利息 = 逾期本金 × 日利率 × 逾期天数
日利率 = 年利率 ÷ 360

【表格格式示例】
期数 | 本金 | 逾期起算日 | 逾期天数 | 日利率 | 逾期利息
---|---|---|---|---|---
3 | 6,692,645.67 | 2021-04-24 | 700 | 0.0169% | 2,342,426.98
4 | 6,692,645.67 | 2021-05-24 | 670 | 0.0169% | 2,242,036.30
... | ... | ... | ... | ... | ...

【特别注意】
1. 表格应显示逾期的22期租金
2. 逾期天数应从应付日期计算到2024年2月24日
3. 逾期利息总和应与案件数据一致
4. 保证金应已用于抵扣利息

请直接输出计算表内容，不要有其他说明。"""


def _prompt_attorney_contract(case_data: Dict[str, Any]) -> str:
    return f"""你是一位律师。请根据以下信息，撰写一份《委托代理合同》。

【任务说明】
这是一份律师服务委托代理合同。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：合同编号、委托方信息、受托方信息、委托事项、代理权限、律师费、签署栏
3. 长度约400-600字
4. 格式应像真实的律师服务合同

【案件数据】
- 合同编号: LV-2024-001
- 委托方: {case_data['原告']}
- 委托方地址: {case_data['原告地址']}
- 受托方: 上海华通律师事务所
- 受托方地址: 上海市某某区某某路某某号
- 案号: {case_data['案号']}
- 案由: 融资租赁合同纠纷
- 律师费: 人民币{case_data['律师费']:,}元
- 代理律师: 左安平、蔡晓薇

【特别注意】
1. 应明确代理权限（特别授权代理）
2. 律师费金额应与案件数据一致
3. 应有具体的案件信息

请直接输出合同内容，不要有其他说明。"""


def _prompt_insurance_policy(case_data: Dict[str, Any]) -> str:
    return f"""你是一位保险经纪人。请根据以下信息，填写一份《诉讼财产保全责任保险保单》。

【任务说明】
这是一份诉讼保全用的责任保险保单。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：保单号、保险人信息、投保人信息、保险期间、保险标的、保险金额、保费、保险条款
3. 长度约400-600字
4. 格式应像真实的保险保单

【案件数据】
- 保单号: XXXXXX
- 保险人: XX保险股份有限公司上海分公司
- 保险人地址: 上海市某某区某某路某某号
- 投保人: {case_data['原告']}
- 投保人地址: {case_data['原告地址']}
- 被申请人: {case_data['被告']}、{case_data['被告二']}、{case_data['被告三']}
- 保险标的: 银行账户、房产等
- 保险金额: 人民币{case_data['未付租金']:,.2f}元
- 保费: 人民币{case_data['保全保险费']:,.2f}元
- 保险期间: 2024年X月X日至2025年X月X日

【特别注意】
1. 保险金额应覆盖诉讼请求金额
2. 保费应与案件数据一致
3. 应有批单信息说明

请直接输出保单内容，不要有其他说明。"""


def _prompt_consulting_contract(case_data: Dict[str, Any]) -> str:
    return f"""你是一位企业法务。请根据以下信息，撰写一份《咨询服务合同》。

【任务说明】
这是一份融资咨询服务合同，通常作为融资租赁的配套服务。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：合同编号、委托方信息、服务方信息、服务内容、服务费、支付凭证、签署栏
3. 长度约400-600字
4. 格式应像真实的服务合同

【案件数据】
- 合同编号: FW-2021-001
- 委托方: {case_data['被告']}
- 委托方地址: {case_data['被告地址']}
- 服务方: {case_data['原告']}
- 服务方地址: {case_data['原告地址']}
- 服务内容: 融资咨询服务（融资方案设计、融资渠道推荐、融资流程指导）
- 服务费: 人民币{case_data['咨询服务费']:,}元

【特别注意】
1. 服务费金额应与案件数据一致
2. 服务内容应合理
3. 应有支付凭证信息

请直接输出合同内容，不要有其他说明。"""


def _prompt_shareholder_decision(case_data: Dict[str, Any]) -> str:
    return f"""你是一位公司秘书。请根据以下信息，撰写一份《股东决定》。

【任务说明】
这是公司对外担保的股东会/股东决定文件。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：公司信息、会议信息、决议内容、股东签字、日期
3. 长度约300-500字
4. 格式应像真实的公司决议

【案件数据】
- 公司名称: {case_data['被告二']}（抵押人）或 {case_data['被告三']}（保证人）
- 公司信用代码: {case_data['被告二信用代码']} 或 {case_data['被告三信用代码']}
- 公司地址: {case_data['被告二地址']} 或 {case_data['被告三地址']}
- 法定代表人: {case_data['被告二法人']} 或 {case_data['被告三法人']}
- 会议日期: {case_data['签订日期']}
- 债务人: {case_data['被告']}
- 债权人: {case_data['原告']}
- 担保债权: 人民币{case_data['合同金额']:,}元

【决议内容示例】
1. 同意为债务人与债权人之间的融资租赁合同项下债务提供担保
2. 明确担保范围包括本金、利息、违约金等
3. 授权法定代表人签署相关合同

【特别注意】
1. 应使用"股东决定"而非"股东会决议"
2. 决议内容应明确具体
3. 应有法定代表人签字栏

请直接输出股东决定内容，不要有其他说明。"""


def _prompt_guarantee_contract(case_data: Dict[str, Any]) -> str:
    return f"""你是一位专业的法律文书撰写人。请根据以下案件信息，撰写一份《保证合同》。

【任务说明】
这是一份连带责任保证担保合同。

【格式要求】
1. 使用【】标注各个章节标题
2. 包含：合同编号、保证人信息、债权人信息、鉴于条款、被担保主债权、保证方式、保证期间、保证范围、公证条款、签署栏
3. 合同总长度约600-900字
4. 语言风格：正式法律文书风格

【案件数据】
- 合同编号: BZ-2021-001
- 保证人: {case_data['被告三']}
- 保证人信用代码: {case_data['被告三信用代码']}
- 保证方法定代表人: {case_data['被告三法人']}
- 保证人地址: {case_data['被告三地址']}
- 债权人: {case_data['原告']}
- 债权人信用代码: {case_data['原告信用代码']}
- 债权方法定代表人: {case_data['原告法人']}
- 债权人地址: {case_data['原告地址']}
- 债务人: {case_data['被告']}
- 被担保债权本金: 人民币{case_data['合同金额']:,}元
- 保证方式: 连带责任保证
- 保证期间: 主债务履行期限届满之日起两年
- 签订日期: {case_data['签订日期']}
- 公证编号: {case_data.get('公证编号', '（2021）沪长证经字第XXXX号')}

【特别注意】
1. 保证方式应明确为"连带责任保证"
2. 保证范围应包含本金、利息、违约金、实现债权费用等
3. 保证期间应符合法律规定
4. 公证条款应与公证编号对应

请直接输出保证合同内容，不要有其他说明。"""


def _prompt_deposit_proof(case_data: Dict[str, Any]) -> str:
    return f"""你是一位财务人员。请根据以下信息，填写一份《保证金收据》。

【任务说明】
这是一份融资租赁保证金收款收据。

【格式要求】
1. 使用【】标注各个信息区块
2. 包含：收据编号、收款内容、收款人信息、附件、备注
3. 长度约200-400字
4. 格式应像真实的财务收据

【案件数据】
- 收据编号: JZ-2021-001
- 日期: {case_data['签订日期']}
- 付款单位（付款人）: {case_data['被告']}
- 收款单位（收款人）: {case_data['原告']}
- 金额: 人民币{case_data['保证金']:,}元
- 大写金额: 人民币肆佰伍拾万元整
- 事由: 融资租赁保证金
- 合同编号: RZL-2021-001
- 收款人: 陈某某
- 复核人: 赵某某

【特别注意】
1. 金额应同时有小写和大写
2. 收据应有编号、日期
3. 应有收款人和复核人签字
4. 备注应说明保证金用途

请直接输出收据内容，不要有其他说明。"""


# ============== 提示词辅助函数 ==============

def get_evidence_type_for_id(evidence_id: str) -> str:
    """根据证据ID确定证据类型"""
    mapping = {
        "E001": "transfer_contract",
        "E002": "finance_lease_contract",
        "E003": "guarantee_contract",  # 抵押合同类似保证合同
        "E004": "mortgage_certificate",
        "E005": "shareholder_decision",  # 股东决定
        "E006": "attorney_contract",
        "E007": "shareholder_decision",
        "E008": "execution_certificate",
        "E009": "assessment_report",
        "E010": "payment_receipt",
        "E011": "consulting_contract",
        "E012": "deposit_proof",
        "E013": "rent_record",
        "E014": "rent_record",  # 逾期记录类似
        "E015": "interest_calculation",
        "E016": "payment_receipt",  # 公证费凭证类似付款凭证
        "E017": "payment_receipt",
        "D001": "payment_receipt",
        "D002": "deposit_proof",
        "D003": "shareholder_decision",  # 困难证明类似说明文件
    }
    return mapping.get(evidence_id, "transfer_contract")


if __name__ == "__main__":
    # 测试提示词生成
    test_data = {
        "原告": "东方国际融资租赁有限公司",
        "原告信用代码": "91310000MA1FL3L123",
        "原告法人": "周明远",
        "原告地址": "中国（上海）自由贸易试验区世纪大道100号",
        "被告": "江西昌盛商业管理有限公司",
        "被告信用代码": "91360121MA35L8T456",
        "被告法人": "吴建华",
        "被告地址": "江西省南昌市南昌县莲塘镇向阳路199号",
        "被告二": "南昌长风房地产开发有限公司",
        "被告二信用代码": "91360103MA35H7U789",
        "被告二法人": "张立军",
        "被告二地址": "江西省南昌市西湖区抚生路369号",
        "被告三": "深圳前海恒信担保有限公司",
        "被告三信用代码": "91440300MA5FQ2K012",
        "被告三法人": "李伟",
        "被告三地址": "广东省深圳市福田区福田街道福华一路6号",
        "合同金额": 150000000,
        "已付租金": 40155653.92,
        "未付租金": 120467622.06,
        "逾期利息": 31198572,
        "保证金": 4500000,
        "律师费": 200000,
        "公证费": 273000,
        "保全保险费": 121663.17,
        "咨询服务费": 4650000,
        "利率": 0.061,
        "租赁期限": 24,
        "签订日期": "2021-02-24",
        "交付日期": "2021-02-26",
        "案号": "（2024）沪74民初721号",
        "公证编号": "（2021）沪长证经字第XXXX号",
    }
    
    prompt = build_prompt("payment_receipt", test_data)
    print("=" * 60)
    print("提示词示例（付款回单）:")
    print("=" * 60)
    print(prompt[:1000] + "...")
